<!DOCTYPE html PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta content="text/html; charset=UTF-8"
 http-equiv="Content-Type">
  <meta content="Laurent Julliard" name="author">
  <meta content="Nicolas Guerin" name="author">
  <title>Installation Guide</title>
</head>
<body>
&nbsp;
<center>
<p><b><font size="+3">Installation Guide</font></b> <br>
&nbsp; </p>
<font size="-1"> Copyright &copy; Xerox Corporation, Codendi 2007-2009.<br>
This file is licensed under the GNU General Public License version 2. See the file COPYING.
</font><br>
</p> 
</center>
<br>
&nbsp;
<br>
<h1><a name="Preamble"></a>Preamble</h1>
The <a
 href="/documentation/installation_guide/html/Installation_Guide.html">
Installation Guide</a> covers the various steps that one has to go
through to install and configure the Codendi software. After or while you
are reading the installation guide we also recommend that you read the <a
 href="/documentation/administration_guide/html/Administration_Guide.html">
Administration Guide</a> which focuses on the various tasks to perform
to properly administrate a Codendi site on a daily basis. <br>
<br>
The Installation procedure is documented so that Codendi adminstrators
learn about the interns of the Codendi software. However the Codendi
installation script provided by Xerox as part of the Codendi software
takes care of most of the installation process described below. After
completion the installation script will inform you of the remaining
configuration that must be done manually.<br>

<h1><a name="Linux_OS_Installation"></a>Linux OS Installation</h1>

Codendi is designed to run on on a PC server (Intel x86 CPU or
compatible) running Linux RedHat Linux Enterprise Server 5 (RHEL5) wether
ES or AS version.
<br>This Linux version is only available with paid-for support. If you
don't need a fully supported server (e.g. a test server or development
server), you may use a free <a href="http://en.wikipedia.org/wiki/RedHat_Enterprise_Linux_clones">RHEL clone distribution</a>.
While those distributions are supposed to be fully binary compatible with
RHEL, they are not tested, nor supported by Xerox.<br>
<br>
<br>
<h2>OS Installation options</h2>
<p>You are free to choose a full, partial, or minimum installation. The Codendi server does not need an X server, KDE, Gnome, etc. But you might find it useful if you intend to use the graphical administration tools. The Codendi installation script will ask for missing RPMs.
<p>Codendi fully supports the <a href="http://www.redhat.com/docs/manuals/enterprise/RHEL-4-Manual/selinux-guide/">SELinux targeted policy</a> implemented in RHEL5. Feel free to enable it ("enforcing") during the installation.
<p>If you choose to install a firewall on the server, make sure that all needed ports are open. This includes:
<ul><li>Apache ports: 80 (HTTP) and 443 (HTTPS)
<li>CVS pserver port: 2401
<li>FTP:  port 21
<li>SSH:  port 22
<li>SMTP: port 25
<li>JDBC: port 3306 (for SaloméTMF JDBC-mode support)
<li>OpenFire (instant messaging server):
  <ul>
  <li>9090 -> administration of OpenFire
  <li>9091 -> same in SSL
  <li>5222 -> XMPP port
  <li>5223 -> same in SSL
  <li>7777 -> proxy file transfer
  <li>8080 and 8483 for http bindings (not used in Codendi 3.6). 
  </ul>
</ul>
<h2>Disk Partitioning</h2>
<p>Before choosing a partitioning scheme, it is important to know where Codendi
data will be located.
<br>The following table shows the main directories used by Codendi:
<table border="1">
<tr><th>Top Directory</th><th>Content</th></tr>
<tr><td><pre>/usr</pre></td><td>Codendi source code is installed in /usr/share/codendi. Size around 300 MB. Total size for the whole /usr directory: up to 8 GB for a full RHEL4 installation.</td></tr>
<tr><td><pre>/home</pre></td><td>Contains Codendi users home directories, and project directories (including project web sites). Size depends on Codendi usage (login shell allowed, web site usage).</td></tr>
<tr><td><pre>/var</pre></td><td>/var/lib/mysql contains the Codendi database, and /var/lib/codendi is Codendi main data directory. It contains CVS and Subversion repositories, file releases, backups . Size: as much as the projects need. This directory should be located in the biggest disk or disk partition.</td></tr>
</table>
<p>Whatever the partitioning scheme chosen, it is always possible to move directories from a partition to another, and create links from their original location. Be warned, though, of potential issues with SELinux: you might need to change security contexts.
<hr size="2" width="100%">
<h1><a name="User_Accounts_and_Group_Settings"></a>User Accounts and
Group Settings</h1>
Specific user accounts and groups that must be created prior to any
manual software installation<br>
<br>
<table align="center" width="80%" border="1" cellspacing="2"
 cellpadding="2">
  <tbody>
    <tr>
      <td bgcolor="#eeeeee" valign="top"><b>User name<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>user id<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>group id<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Full Name<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>home dir<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>shell<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Remarks<br>
      </b></td>
    </tr>
    <tr>
      <td valign="top">codendiadm</td>
      <td valign="top"><br>
      </td>
      <td valign="top"><br>
      </td>
      <td valign="top">Owner of Codendi directories</td>
      <td valign="top">/home/codendiadm</td>
      <td valign="top">/bin/bash</td>
      <td valign="top">Set a password<br>
      </td>
    </tr>
    <tr>
      <td valign="top">dummy</td>
      <td valign="top"><br>
      </td>
      <td valign="top"><br>
      </td>
      <td valign="top">Dummy Codendi user<br>
      </td>
      <td valign="top">/var/lib/codendi/dumps</td>
      <td valign="top">/bin/bash</td>
      <td valign="top">Set same password as codendiadm<br>
      </td>
    </tr>
    <tr>
      <td valign="top">mailman</td>
      <td valign="top">106<br>
      </td>
      <td valign="top">106<br>
      </td>
      <td valign="top">Owner of Mailman directories</td>
      <td valign="top">/usr/lib/mailman</td>
      <td valign="top">/bin/bash</td>
      <td valign="top">- shell login not allowed<br>
- Set same password as codendiadm<br>
      </td>
    </tr>
    <tr>
      <td valign="top">ftpadmin</td>
      <td valign="top"><br>
      </td>
      <td valign="top"><br>
      </td>
      <td valign="top">FTP Administrator</td>
      <td valign="top">/var/lib/codendi/ftp</td>
      <td valign="top">&nbsp;-<br>
      </td>
      <td valign="top">shell login not allowed</td>
    </tr>
    <tr>
      <td valign="top">ftp<br>
      </td>
      <td valign="top"><br>
      </td>
      <td valign="top"><br>
      </td>
      <td valign="top">FTP User<br>
      </td>
      <td valign="top">/var/lib/codendi/ftp</td>
      <td valign="top">-<br>
      </td>
      <td valign="top">shell login not allowed<br>
      </td>
    </tr>
  </tbody>
</table>
<div align="center"><br>
<br>
<br>
</div>
<table align="center" width="80%" border="1" cellspacing="2"
 cellpadding="2">
  <tbody>
    <tr>
      <td bgcolor="#eeeeee" valign="top"><b>Group name<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>group id<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Group members<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Remarks<br>
      </b></td>
    </tr>
    <tr>
      <td valign="top">codendiadm</td>
      <td valign="top"><br>
      </td>
      <td valign="top">-<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">dummy</td>
      <td valign="top"><br>
      </td>
      <td valign="top">-<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">mailman</td>
      <td valign="top">106<br>
      </td>
      <td valign="top">-<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">ftpadmin</td>
      <td valign="top"><br>
      </td>
      <td valign="top">ftpadmin, codendiadm</td>
      <td valign="top"><br>
      </td>
    </tr>
  </tbody>
</table>
<div align="center"><br>
</div>
<h2>Authentication with libnNSS-MySQL</h2>
<p>Starting with Codendi 4.0, Codendi users are now directly authenticated against the MySQL database.
There is no longer need to edit /etc/passwd, /etc/shadow and /etc/group.
Only the system users listed above still need to exist in those files (codendiadm, mailman, ftp, etc.).
<h3>Configuration files</h3>
LibNSS-MySQL needs two configuration files: /etc/libnss-mysql.cfg and /etc/libnss-mysql-root.cfg.
Those files contain the queries that map system calls to SQL syntax. We provide sample files (.dist) for codendi in /usr/share/codendi/src/etc.
<h3>nsswitch.conf</h3>
In order to use libnss-mysql, one need to update /etc/nsswitch.conf to inform the system that it can use mysql for name service requests.
Here is an extract from a sample nsswitch.conf (it is automatically updated by the Codendi installation script):
<pre>
passwd:     files mysql
shadow:     files mysql
group:      files mysql
</pre>
This means that if a user or group is not found in the corresponding file (/etc/passwd or /etc/group), the system will look into the MySQL DB.
<h3>NSCD</h3>
Using MySQL for system calls is slower that using the dedicated files. For this reason, we decided to deploy nscd (Name Service Caching Daemon) by default with Codendi.
This daemon stores successfull name service requests into a cache for faster performance. Please note, however, that each time a user or a project is created, or a new member is added to a project, we need to clear the nscd cache. This is done automatically by the Codendi backend.

<hr size="2" width="100%">
<h1><a name="File_System_Settings"></a>File System Settings</h1>
Directory that must be created on the filesystem prior to software
installation. For a description of the content of each directory see
the
<a
 href="/documentation/administration_guide/html/Administration_Guide.html">Codendi
Administration Guide</a>.<br>
<br>
<table align="center" width="80%" border="1" cellspacing="2"
 cellpadding="2">
  <tbody>
    <tr>
      <td bgcolor="#eeeeee" valign="top"><b>Directory path<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Ownership<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>permission<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Remarks<br>
      </b></td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>Codendi Users and
Projects Directories</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/home/users</td>
      <td valign="top">codendiadm.codendiadm<br>
      </td>
      <td valign="top">drwxrwxr-x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/home/groups</td>
      <td valign="top">codendiadm.codendiadm </td>
      <td valign="top">drwxrwxr-x </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>Temporary Codendi
database dumps</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/home/dummy</td>
      <td valign="top">dummy.dummy<br>
      </td>
      <td valign="top">drwx------<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/dumps</td>
      <td valign="top">dummy.dummy </td>
      <td valign="top">drwxr-xr-x</td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>FTP storage spaces
(incoming, anonymous and file release space)</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/ftp<br>
      </td>
      <td valign="top">root.ftp<br>
      </td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top">Create a welcome.msg file in this directory with
instructions for people uploading/downloading code (see example on
Codendi
central server<br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/ftp/bin<br>
/var/lib/codendi/ftp/etc<br>
      </td>
      <td valign="top">ftpadmin.ftpadmin<br>
      </td>
      <td valign="top">d--x--x--x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/ftp/lib<br>
      </td>
      <td valign="top">ftpadmin.ftpadmin</td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/ftp/codendi<br>
      </td>
      <td valign="top">root.root<br>
      </td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/ftp/pub<br>
      </td>
      <td valign="top">ftpadmin.ftpadmin<br>
      </td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/ftp/incoming<br>
      </td>
      <td valign="top">ftpadmin.ftpadmin<br>
      </td>
      <td valign="top">drwxrwsrwt<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>CVS directories</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/tmp<br>
      </td>
      <td valign="top">&nbsp;root.root<br>
      </td>
      <td valign="top">drwxrwxrwt<br>
      </td>
      <td valign="top">Temporary storage space for cvs commit (needs a
lot of space so we can not keep the default /tmp location)<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">/var/run/log_accum<br>
      </td>
      <td style="vertical-align: top;">root.root<br>
      </td>
      <td style="vertical-align: top;">drwxrwxrwt<br>
      </td>
      <td style="vertical-align: top;">Temporary storage space for the
cvs tracking script that feed the Codendi database<br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/cvsroot<br>
      </td>
      <td valign="top">codendiadm.codendiadm</td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top">Where all CVS repo reside.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">/cvsroot<br>
      </td>
      <td valign="top">root.root</td>
      <td valign="top">lrwxrwxrwx<br>
      </td>
      <td valign="top">Link to /var/lib/codendi/cvsroot.<br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>Subversion directory</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/lib/codendi/svnroot<br>
      </td>
      <td valign="top">codendiadm.codendiadm</td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top">Where all Subversion repositories reside.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">/svnroot<br>
      </td>
      <td valign="top">root.root</td>
      <td valign="top">lrwxrwxrwx<br>
      </td>
      <td valign="top">Link to /var/lib/codendi/svnroot.<br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>Log files
(http/cvs/ftp traffic archive)</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/log/codendi/<br>
      </td>
      <td valign="top">codendiadm.codendiadm</td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/log/codendi/cvslogs<br>
      </td>
      <td valign="top">codendiadm.codendiadm</td>
      <td valign="top">drwxrwxr-x<br>
      </td>
      <td style="vertical-align: top;">Daily generated log files of all
CVS repo hosted on Codendi (used for stattistics purposes)<br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>Cache for generated
HTML</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">/var/tmp/codendi_cache<br>
      </td>
      <td valign="top">codendiadm.codendiadm</td>
      <td valign="top">drwxr-xr-x<br>
      </td>
      <td valign="top"><br>
      </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>MySQL directories</b><br>
      </td>
    </tr>
    <tr>
      <td valign="top">
/var/lib/mysql
      </td>
      <td valign="top">
mysql.mysql
      </td>
      <td valign="top">drwxr-xr-x
      </td>
      <td valign="top">In case you have not enough space in /var you
can move the /var/lib/mysql directory to /home/var/lib/mysql and create
a symbolic link in /var/lib:<br>
      <span style="font-family: monospace;">$ cd /var/lib/ ; mv
/var/lib/mysql /home/var/lib; ln -s /home/var/lib/mysql<br>
      </span><span style="font-weight: bold;">NOTE: the mysql user will
only be available once the MySQL packages are installed (see section </span><a
 href="#RPM_Packages">RPM Packages</a>)<span
 style="font-family: monospace;"><br>
      </span> </td>
    </tr>
    <tr>
      <td colspan="4" rowspan="1" valign="top"><b>User Directory
Startup files</b></td>
    </tr>
    <tr>
      <td valign="top">/etc/skel_codendi<br>
      </td>
      <td valign="top">root.root<br>
      </td>
      <td valign="top">drwxr-xr-x&nbsp; <br>
      </td>
      <td valign="top">All the files that you place in this directory
will be copied in the user's home directory when created. This would
typically contain startup files (e.g. hidden files like .bash_profile,
.bash_logout...) that you want to run when a user logs in with its
telnet/shell account.<br>
      </td>
    </tr>
  </tbody>
</table>
<div align="center"><br>
<br>
</div>
<br>
<hr size="2" width="100%">
<h1><a name="SELinux"></a>SELinux Support</h1>
<p>
Codendi is compatible with the SELinux targeted policy defined in RedHat Enterprise Linux 5.
SELinux enforcement is not required by Codendi, but it is recommended for servers accessible from the internet.
<p>In order to run Codendi when SELinux is in 'enforcing' state, it is required to make some specific adjustements to both directory contexts and SELinux policy.
<h3>SELinux directory contexts</h3>
The 'httpd' daemon needs to access paths that are not defined in the standard RHEL5 SELinux installation: 
Codendi installation directory, custom directory, data directory (for file packages, documents) ,
codendiadm subversion directory (for server update plugin),
project directories (for project web sites) and source code repositories (for ViewVC).
<br> 
You can execute the 'fix_selinux_contexts.pl' Perl script located in /usr/share/codendi/src/utils to setup SELinux directory contexts automatically.

<h3>New SELinux modules</h3>
<p>Codendi also needs specific rules that must be added to the RedHat default
targeted policy.
<p>SELinux rules for Codendi are provided in /usr/share/codendi/codendi_tools/selinux, in both textual and binary format.
In order to load a binary module, simply type:
<pre>
semodule -i modulename.pp
</pre>
You can load all Codendi-provided modules by running the 'fix_selinux_contexts.pl' Perl script located in /usr/share/codendi/src/utils.
<h3>Compiling SELinux modules</h3>
<p>
Please read the <a href="http://www.redhat.com/docs/manuals/enterprise/RHEL-5-manual/Deployment_Guide-en-US/selg-overview.html">
RedHat official SELinux documentation</a> for a detailed explanation of SELinux customization.
<p>
Building (or updating) an SELinux module is done in several steps:
<ol><li>Generate a source file from audit messages. SELinux modules can be built from access denial messages: RedHat provides tools to analyse those messages and create rules to enable access. For instance, to read all denial messages produced by the 'cvs' command, you can type:
<pre>
ausearch -m AVC --comm cvs
</pre>
And to build a SELinux module from these messages:
<pre>
ausearch -m AVC --comm cvs | audit2allow  -M cvs
</pre>
This will create a file "cvs.te" containing the SELinux rules to suppress the denial messages, as well as a file "cvs.pp", which is the compiled, ready-to-use module.
<li>You can edit the module source file by hand (e.g. to combine modules) (e.g. edit "cvs.te").
<li>Compile the module:
<pre>
checkmodule -M -m cvs.te -o cvs.mod
</pre>
<li>Package the module:
<pre>
semodule_package -o cvs.pp -m cvs.mod
</pre>
<li>And then, the module is ready for installation. You can install (or uninstall) it with the "semodule" command:
<pre>
semodule -i cvs.pp
</pre>
</ol>

<hr size="2" width="100%">
<h1><a name="Specific_Software_Packages"></a>Specific Software Packages</h1><h2><a name="RPM_Packages"></a>RPM Packages</h2>
Codendi requires a number of specific packages to operate properly.
These packages are provided either through the RedHat Linux Enterprise
Server distribution or by Xerox as part of your support contract. It is
the responsibility of the Codendi Administrators to make sure that they
keep RPMs up-to-date with latest versions provided by RedHat or by Xerox
for the Codendi specific RPMs.<br>
<br>
<table width="80%" border="1" cellspacing="2" cellpadding="2">
  <tbody>
    <tr>
      <td valign="top" style="font-weight: bold;">Codendi Specific
Packages<br>
      </td>
      <td valign="top" style="font-weight: bold;">Items to Install<br>
      </td>
    </tr>
    <tr>
      <td valign="top">codendi-eclipse<br>
      </td>
      <td valign="top">Install the Codendi Eclipse software. This RPM is needed if you activate the Eclipse plugin.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">codendi-salome<br>
      </td>
      <td valign="top">Install the Codendi SaloméTMF package. This RPM is needed if you activate the SaloméTMF plugin.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">cvs or cvsnt<br>
      </td>
      <td valign="top">Install the cvs or cvsnt package. If you use CVS, make sure you use a package provided with Codendi: it is a patched version.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">cvsgraph<br>
      </td>
      <td style="vertical-align: top;">Install the cvsgraph package
(used by viewvc to build a graphical view of CVS branches)<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">subversion<br>
      </td>
      <td style="vertical-align: top;">Install the subversion,
mod_dav-svn, subversion-tools, subversion-perl and subversion-python packages<br>
      </td>
    </tr>
    <tr>
      <td valign="top">jre<br>
      </td>
      <td valign="top">The Java Runtime environment is required to
generate the HTML and PDF version of the Codendi User Guide. Install the
jre rpm.<br>
      <br>
The package normally installs in /usr/java. Once installed make sure
you create a symbolic link in /usr/java from 'jre' pointing to
'jre_xxxx' where xxxx is the version number. This is required by the
DocBook processing chain to generate the Codendi User Guide.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">viewvc<br>
      </td>
      <td style="vertical-align: top;">Install the viewvc package.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">enscript<br>
      </td>
      <td style="vertical-align: top;">Install the enscript package, used by viewVC for syntax highlighting.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">highlight<br>
      </td>
      <td style="vertical-align: top;">Install the highlight package, used by phpWiki for syntax highlighting.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">HTML Purifier<br>
      </td>
      <td style="vertical-align: top;">Install the htmlpurifier PHP package. It is used by Codendi to filter HTML input.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Mailman<br>
      </td>
      <td style="vertical-align: top;">Install the customized Mailman package. It is configured specifically for Codendi (with the proper group IDs defined at compile time)<br>
      </td>
    </tr>
    <tr>
      <td valign="top">openfire<br>
      </td>
      <td valign="top">Install the OpenFire package. OpenFire is a Jabber/XMPP server. This RPM is needed if you activate the Instant Messaging plugin.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">Stock RedHat<br>
      </td>
      <td valign="top">Codendi needs a number of RedHat packages that may not be installed by default (e.g. php-soap, apr, bind, etc.).
The /usr/share/codendi/codendi_install.sh installation script contain the list of required RPMs. During installation, this script will complain if packages are missing.
      </td>
    </tr>
  </tbody>
</table>
<br />
<h2>Non RPM packages</h2>
Codendi also requires a number of specific packages that are not
delivered
in the form of RPM files. These packages are also compiled and
installed automatically when Codendi is first installed.<br>
<br>
<table width="80%" border="1" cellspacing="2" cellpadding="2">
  <tbody>
    <tr>
      <td valign="top" style="font-weight: bold;">Software Component<br>
      </td>
      <td valign="top" style="font-weight: bold;">Items to Install<br>
      </td>
    </tr>
    <tr>
      <td valign="top">docbook<br>
      </td>
      <td valign="top">In this directory you'll find all the programs
required to generate the PDF and HTMl version of the Codendi
Documentation
(Codendi User Guide). All the packages (delivered in tar gzip'ed format
must be installed in /usr/local:<br>
      <ul>
        <li>docbook-dtd-x.y.z.tgz: the DocBook Schema itself.&nbsp;</li>
        <li>docbook-xsl-x.y.z.tgz: DocBook XSL stylesheets.&nbsp;</li>
        <li>fop-x.y.z.tgz: the Apche FOP PDF generator.&nbsp;</li>
        <li>Jimi-x.y.tgz: a java image processing software needed by FOP</li>
        <li>saxon-x.y.z.tgz: XSLT engine to process the DocBook XML
documents</li>
      </ul>
Each of these packages must be dearchived in /usr/local and for each
directory make sure your create a generic symbolic link (with no
version
number in it) to the top level directory. Like this:<br>
      <blockquote>docbook-dtd &nbsp;-&gt; docbook-dtd-x.y.z<br>
docbook-xsl &nbsp;-&gt; docbook-xsl-x.y.z<br>
fop -&gt; fop-x.y.z<br>
jimi -&gt; Jimi-x.y.z (Caution!! symbolic link uses lower case only)<br>
etc...<br>
      </blockquote>
      </td>
    </tr>
    <tr>
      <td valign="top">utilities<br>
      </td>
      <td valign="top">A series of small utilities that are needed by
the PHP scripts and the Codendi backend to operate properly. &nbsp;See
the <a href="#Miscellaneous_Utilities">Miscellaneous Utilities</a>
section
below for more information<br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<br>
<br>
<hr>
<h1><a name="DNS_Configuration"></a>DNS Configuration</h1>
Codendi has its own domain name and the name server for the Codendi
domain is hosted on the central Codendi server. <br>
<h2>DNS Zone file</h2>
Your DNS zone (called codendi.zone) definition file must be placed in <tt>/var/named/chroot/var/named</tt>.
<br>
As an example here is how the codendi.zone file looks like on the Codendi
central site of the Xerox Corporation. Adapt the file to your own needs:<br>
<br>
<blockquote><tt>$TTL 3600</tt><br>
  <tt>@&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SOA&nbsp;&nbsp;&nbsp;&nbsp;
atlas.codendi.xerox.com. dns_support\.cinops.xerox</tt><br>
  <tt>.com. (</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2002101805&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ; Serial</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3600&nbsp;&nbsp;&nbsp; ; Refresh 1 hour</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
900&nbsp;&nbsp;&nbsp;&nbsp; ; Retry 15 minutes</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
604800&nbsp; ; Expire in 7 days</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3600 )&nbsp; ; Minimum TTL 1 hours</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
atlas.codendi.xerox.com.</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
athena.xerox.com.</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
beta.xerox.com.</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
carme.xerox.com.</tt><br>
  <tt>localhost&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
127.0.0.1</tt><br>
  <tt>;----------------------------------------------------------------------</tt><br>
  <br>
  <tt>codendi.xerox.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
13.0.33.116</tt><br>
  <tt>atlas&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
13.0.33.116 ; production server</tt><br>
  <tt>atlas2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
13.0.33.45&nbsp; ; backup server</tt><br>
  <br>
  <tt>codendi.xerox.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; atlas.codendi.xerox.com.</tt><br>
  <tt>codendi.xerox.com.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailer-east.xerox.com.</tt><br>
  <tt>;</tt><br>
  <tt>www&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>xww&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>cvs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>cvs1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>svn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>svn1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>download&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>shell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>shell1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>users&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>cxdocs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas</tt><br>
  <tt>lists&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp; 13.0.33.116</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; lists.codendi.xerox.com.</tt><br>
  <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailer-east.xerox.com.</tt><br>
<tt>  <br>
;<br>
; Wildcard DNS entry, to match all possible hosts: projnamme.*, cvs.projname.*, svn.projname.*, etc.<br>
;<br>
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CNAME&nbsp;&nbsp; atlas<br>
<br>
</tt></blockquote>
<br>
<br>
As you can see the Codendi central hosts all the Codendi services on a
single physical
server. Hence the alias to the atlas machine name for all other logical
servers (CVS, SVN, mail, download, shell account,etc...). The reason for
defining
those aliases is that at the site grows you are given the flexibility
to
export specific services to a separate server
and all you'll have to do is to redefine the alias name to point to
the IP address of the new server. Note that all servers must
remain in the Codendi domain.<br>
<br>
<h2>Named.conf file</h2>
<span style="font-family: monospace;">/var/named/chroot/etc/named.conf</span> is the
master DNS configuration file. As an example,
here is a sample file:<br>
<pre>
//
// named.caching-nameserver.conf
//
// Provided by Red Hat caching-nameserver package to configure the
// ISC BIND named(8) DNS server as a caching only nameserver
// (as a localhost DNS resolver only).
//
// See /usr/share/doc/bind*/sample/ for example named configuration files.
//
//
options {
//      listen-on port 53 { 127.0.0.1; };
        listen-on-v6 port 53 { ::1; };
        directory       "/var/named";
        dump-file       "/var/named/data/cache_dump.db";
        statistics-file "/var/named/data/named_stats.txt";
        memstatistics-file "/var/named/data/named_mem_stats.txt";
        query-source    port *;
        query-source-v6 port *;
        allow-query     { any; };

        forwarders {
                13.202.220.10; // Put your own DNS forwarders list here!!!
        };
};
logging {
        channel default_debug {
                file "data/named.run";
                severity dynamic;
        };
};

include "/etc/named.rfc1912.zones";

zone "codendi.xerox.com" {
                type master;
                file "codendi.zone";
};
</pre>

<br>
<hr size="2" width="100%">
<h1><a name="Apache_Configuration"></a>Apache Configuration</h1>
<ul>
  <li>A sample Apache configuration file is available in the Codendi code
in <tt>/usr/share/codendi/src/etc/http.conf.dist</tt>. Edit this file to
reflect your site settings and place it in <tt>/etc/httpd/conf/httpd.conf</tt>.</li>
  <li>Modules configuration must
be placed in <tt>/etc/httpd/conf.d/</tt> . Codendi comes with a number
of Apache modules configuration files that must be copied from <tt>/usr/share/codendi/src/etc/</tt>
to <tt>/etc/httpd/conf.d/</tt> (e.g. php.conf, ssl.conf,etc.). 
  <li>Please not that, by default, <b>all</b> 
configuration files (ending with .conf) located in <tt>/etc/httpd/conf.d/</tt> are included in both httpd.conf and ssl.conf.
For this reason, you may want to remove or delete useless configuration files (e.g. perl.conf, python.conf, etc).
  <li>Directory aliases (e.g. '/documentation', or '/phpMyAdmin') used to be defined in httpd.conf top level. This caused potential issues with virtual hosts defined for Codendi. For instance, the URL http://guineapig.codendi.xerox.com/documentation did not point to a "documentation" directory located in the Guinea Pig htroot directory, but to the main Codendi documentation tree. For this reason, Codendi aliases are defined per virtualhost. This is why configuration files are loaded in both the main virtual host, and the secure (HTTPS) virtual host.
  <li>For the same reason, the ssl.conf file is moved from 'conf.d' to 'conf' (so that it does not include itself).
<br>
    </tt></li>
  <li>Start or restart the Apache web server (from the root account
type the command: 'service httpd restart')<br>
  </li>
</ul>
<h2>Secure Apache (https)</h2>
Before you activate SSL in Apache make sure the standard RedHat openssl
package is installed. Then you must either generate your own test
certificate or you must get one from a certified company and install it
in the right place. The RedHat Manual has excellent instructions on how
to do generate a self-signed certificate. See the section called 
<a href="http://www.redhat.com/docs/manuals/enterprise/RHEL-5-manual/Deployment_Guide-en-US/s1-httpd-secure-server.html">Apache HTTP Secure Server Configuration</a>
<p>
You will also find a script that will automate these tasks for you (/usr/share/codendi/src/utils/generate_ssl_certificate.sh)
<p>
Note: although RedHat recommends that you generate a password protected
key for your certificate it has some serious implications. The most
noticeable is that a system administrator must be physically present
while rebooting the Codendi system to type the password when the Apache
server is started. This prevents from doing an unattended reboot.<br>
<br>
To activate SSL on your Codendi server simply copy the sample <span
 style="font-family: monospace;">/usr/share/codendi/src/etc/ssl.conf.dist</span>
file to <tt>/etc/httpd/conf/</tt>. It contains all the necessary
Apache directives
to enable secured HTTP. Then do the following:<br>
<ul>
  <li>Edit <tt>/etc/httpd/conf/ssl.conf</tt> and replace the <tt>%sys_ip_address%
    </tt>and <tt>%sys_default_domain% </tt>patterns with the
appropriate values for your site.<tt><br>
    </tt></li>
  <li>For the changes to take effect you must restart the Apache server.</li>
  <li>Then edit the /etc/codendi/conf/local.inc file and edit the
$sys_https_host
variable (in most cases this will be the same name as the
$sys_default_domain variable. If the port number you use for https is
not the regular one (443) then you must specify the port number
explicitely in the host name.</li>
  <li>In the same /etc/codendi/conf/local.inc file, you can also tune the
$sys_force_ssl variable to determine how HTTPS is
going to be used/enforced on your site.<br>
  </li>
</ul>
<br><b>Note:</b> If you want to use the Eclipse plugin or the SaloméTMF client with an HTTPS-only server, you will need a <b>valid certificate from a certified authority</b>. Java is very touchy about certificates, and Eclipse and Salomé won't run with an HTTPS server presenting a self-signed certificate, or with a name different from the one specified in the certificate.
<br>
<hr size="2" width="100%">
<h1><a name="Installing_the_Codendi_Software"></a>Installing the Codendi
Software</h1>
<ul>
  <li>Before you install the Codendi software make sure you have a user
account on the Partners or central Codendi server. You'll need this user account to
update the source code from the Codendi Subversion repository.</li>
  <li>Ask us
to add you to the codendi-svnevents mailing list to automatically receive
all the commit made to the Central repository of Codendi so you know
what modifications are being made and what to do to upgrade.&nbsp;</li>
  <li><font color="#ff0000">If you want to develop a new feature, <b>PLEASE</b>
get in touch with the Codendi Team to talk about it first. By doing so we
can mutualize our development resources and make your effort beneficial
to the entire Xerox community. Plus we can provide you with useful
guidelines and tips. In addition remember that the Codendi code is
subject
to the GNU GPL license.&nbsp;</font></li>
</ul>
<hr size="2" width="100%">
<h1><a name="Configuring_the_Codendi_Software"></a>Configuring the Codendi
Software</h1>
As user root:<br>
<ul>
  <li>copy /usr/share/codendi/src/etc/local.inc.dist in
/etc/codendi/conf/local.inc and /usr/share/codendi/src/etc/database.inc.dist in
/etc/codendi/conf/database.inc</li>
  <li>change local.inc and database.inc ownership (e.g. chown
codendiadm.codendiadm
/etc/codendi/conf/local.inc)</li>
  <li>change permission (e.g. chmod 640 /etc/codendi/conf/local.inc) <b><font
 color="#ff0000">**HIGHLY CRITICAL**</font></b></li>
</ul>
A couple of remarks on the some the variables in local.inc:<br>
<ul>
  <li><b>Machine names</b>: The local.inc and database.inc files are included by all Codendi
PHP scripts and contains global variables that are used throughout the
site. These files are also read by the backend Perl scripts and Python scripts (see below).
&nbsp;You'll see that Codendi allows you to give distinct machine names
that will be in charge of the various Codendi services (Web front end,
CVS, Shell account, list manager,etc.). Even if you run all those
services on the same machine we strongly encourage you to give
different
names for the various services and setup your DNS server so that all
these are actually aliases to the same physical server. The reason is
that it gives you the freedom, later in the life of the site, to
delocalize a given service on a distinct machine without having to mess
up with the Codendi database. The simple fact of assigining a new IP
adress to what used to be a simple alias will automagically redirect
all
the traffic for this service to the right machine.</li>
  <li><b>Database parameters</b> ($sys_dbxxx) : you'll have to provide
the password for the MySQL codendiadm user here so make sure you have
set the file permission of database.inc correctly (see above)</li>
  <li><b>Codendi News group</b> ($sys_news_group): this is a reserved
Codendi group_id. Leave this value unchanged.</li>
  <li><b>Site language</b> ($sys_lang): right now, Codendi supports two languages: English (en_US) and French (fr_FR).</li>
  <li><span style="font-weight: bold;">HTTPS host </span>($sys_https_host):
if your Apache server is SSL enabled (HTTPS protocol) set this variable
with name/port number of the host to talk to. In general it is the same
name as $sys_default_domain. Set it to an empty string ($sys_https_host
= "") if your site is not SSL enabled.</li>
</ul>
<h2>PHP configuration</h2>
<p>Most PHP configuration is now defined in /etc/httpd/conf.d/php.conf instead of /etc/php.ini.
<ul>
  <li>Codendi still needs the register_globals parameter to be set.
   It is 'off' by default starting with PHP5, so add this line to php.conf:<br>
    <pre>   php_value register_globals on</pre>
    <pre>   php_flag magic_quotes_gpc on</pre>
  </li>
  <li>Update the include_path variable to the following value:<br>
    <pre>   php_value include_path "/usr/share/codendi/src/www/include:/usr/share/codendi/src:."</pre>
  </li>
  <li>Also set/tune some additional variable for upload size:<br>
    <pre>   php_value memory_limit 30M
   php_value post_max_size 20M
   php_value upload_max_file_size 20M
   php_value upload_tmp_dir /var/tmp</pre>
  </li>
  <li>Use /var/tmp as temporary directory to store uploaded file:
   <pre>   php_admin_value upload_tmp_dir /var/tmp</pre>
  </li>
  <li>phpWiki also needs thess parameters:<br>
    <pre>   php_value allow_call_time_pass_reference on</pre>
    <pre>   php_flag register_long_arrays on</pre>

  </li>
</ul>
<h2>Modifying maximum size of uploaded files</h2>
<p>
By default, the maximum size of an artifact attachment is 16 MB, and the
maximum size of a project document is 64 MB.
Still, it is possible to modify these default values by modifying two
parameters in local.inc:
<br>
</p>
<ul>
  <li><span style="font-weight: bold;">sys_max_size_attachment</span>:
this is the maximum size of an attachment, either for a bug, a task or
any artifact. </li>
  <li><span style="font-weight: bold;">sys_max_size_upload</span>: this
is the maximum size of a document, a patch, a code snippet or a quick
file release.</li>
</ul>
If you wish to go over the existing limit you might also have to modify the following
files:
<ul>
  <li>/etc/httpd/conf.d/php.conf as described above </li>
  <li>/etc/my.cnf i.e. the MySQL configuration file. Specify a <span
 style="font-family: monospace;">max_allowed_packet</span> value above
the maximum size you chose. </li>
</ul>

<p>As a rule of thumb, if the $sys_max_size_upload is equal to N Mbytes then the other parameters should have the following values:</p>

<table align="center" width="80%" border="1" cellspacing="2"
 cellpadding="2">
  <tbody>
    <tr>
      <td bgcolor="#eeeeee" valign="top"><b>Parameter name<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>File<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Value (MBytes)<br>
      </b></td>
      <td bgcolor="#eeeeee" valign="top"><b>Remarks<br>
      </b></td>
    </tr>
    <tr>
      <td valign="top">sys_max_size_upload<br>
      </td>
      <td valign="top">/etc/codendi/conf/local.inc<br>
      </td>
      <td valign="top">N<br>
      </td>
      <td valign="top">&nbsp;<br>
      </td>
    </tr>
    <tr>
      <td valign="top">upload_max_file_size<br>
      </td>
      <td valign="top">/etc/httpd/conf.d/php.conf<br>
      </td>
      <td valign="top">N<br>
      </td>
      <td valign="top">&nbsp;<br>
      </td>
    </tr>
    <tr>
      <td valign="top">post_max_size<br>
      </td>
      <td valign="top">/etc/httpd/conf.d/php.conf<br>
      </td>
      <td valign="top">N+1<br>
      </td>
      <td valign="top">&nbsp;<br>
      </td>
    </tr>
    <tr>
      <td valign="top">memory_limit<br>
      </td>
      <td valign="top">/etc/httpd/conf.d/php.conf<br>
      </td>
      <td valign="top">4*N<br>
      </td>
      <td valign="top">We have to multiply by 4 because of the (legacy) document manager which stores the document in the database. We first have to escape the file data before building the SQL query. This in the worst case can double the size. And then we have to build the SQL query, which doubles the amount of memory again.<br>
      </td>
    </tr>
    <tr>
      <td valign="top">max_allowed_packet<br>
      </td>
      <td valign="top">/etc/my.cnf<br>
      </td>
      <td valign="top">2*N+1<br>
      </td>
      <td valign="top">Escaping the file data can double the size of the data, plus 1 Mbyte for the other fields of the SQL query.<br>
      </td>
    </tr>
</table>

<hr size="2" width="100%">
<h1><a name="Installing_the_Codendi_Database"></a>Installing the Codendi
Database</h1>
As user root go through the following steps:<br>
<br>
<h2>Move the mysql data directoy</h2>
<ul>
  <li>Make sure the official MySQL RPMs are installed (see above)</li>
  <li>Make sure the mysql engine is started (command is 'service mysql
start')</li>
</ul>
<h2>Create Codendi database</h2>
<p>As root, run in a shell </p>
<pre>		mysql -e "create database codendi"<br><br></pre>
<h2>Define access permission</h2>
<ul>
  <li>Choose distinct&nbsp; passwords for the MySQL 'codendiadm'
account &nbsp;<b>and</b> 'root' account. We recommend that you use the
same passwords as those you chose for the codendiadm Unix account and
root Unix account created earlier.&nbsp;</li>
  <li>Then run mysql on the mysql database: </li>
</ul>
<pre>		# mysql mysql<br><br>		mysql&gt; GRANT ALL PRIVILEGES<br>      on *.* <br>      to codendiadm@localhost <br>      identified by 'password';<br><br>		mysql&gt; GRANT ALL PRIVILEGES<br>      on *.* <br>      to root@localhost <br>      identified by 'password';<br>				  <br>		mysql&gt; Flush Privileges;<br>		mysql&gt; quit<br><br></pre>
From now onwards if you want to use the mysql shell to interact with
the Codendi database (think twice before doing any change by hand in the
database !!!) you'll have to run the following command and type the
codendiadm password when prompted:<br>
<br>
<pre>		# mysql -u codendiadm codendi -p<br></pre>
<br>
<h2>Populate the database</h2>
To create the tables in the Codendi database and populate the database
with the initial values one needs to type a few commands:
<pre>cd /usr/share/codendi/src/db/mysql/<br>mysql -u codendiadm codendi -p &lt; database_structure.sql   # create the DB<br>mysql -u codendiadm codendi -p &lt; database_initvalues.sql  # populate with init values.<br><br>If you make a mistake in the creation process and want to restart from scratch run the following command:<br></pre>
<pre>mysql -e "drop database codendi"<br><br></pre>
<h2>MySQL configuration file</h2>
The /etc/my.cnf configuration file is here to specify a number of
configuration items that are going to be used by the MySQL engine at
run
time.&nbsp; Right now the configuration file looks like this<br>
<br>
<span style="font-family: monospace;"># The MySQL server</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">[mysqld]</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">log-bin=codendi-bin</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">set-variable =
max_allowed_packet=128M</span><br style="font-family: monospace;">
<br style="font-family: monospace;">
<span style="font-family: monospace;">[safe_mysqld]</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">err-log=/var/log/mysqld.log<br>
<br>
</span>
<hr>
<h1><a name="Mail_Configuration"></a>Mail Configuration</h1>
By default, Codendi uses sendmail as Mail transfer agent but it is possible to use
any other MTA like Postfix, Exim or other.<br>
<br>
<h2>Sendmail settings</h2>
<u>In /etc/mail/sendmail.cf:</u><br>
<ul>
  <li>Set Cw to codendi.xerox.com (or change the domain name to your own). If you get errors like "config error: mail loops back to me (MX problem?)" when sending emails to lists.codendi.xerox.com, you may need to add this domain in the CW. Then the line looks like:
<pre>
Cwcodendi.xerox.com lists.codendi.xerox.com
<pre></li>
  <li>Set DM to codendi.xerox.com (this is what we masquerade as):
<pre>
DMcodendi.xerox.com
<pre></li>
  <li>To modify sendmail to accept remote connections in the sendmail.cf file, comment out (or delete) the following line:
<pre>O DaemonPortOptions=Port=smtp,Addr=127.0.0.1, Name=MTA</pre>
The commented out version of this line would then look like so:
<pre>#O DaemonPortOptions=Port=smtp,Addr=127.0.0.1, Name=MTA</pre>
  <li>Aliases files should have been automatically set up. They are:<br>
    <pre>O AliasFile=/etc/aliases,/etc/aliases.codendi</pre>
  </li>
  <li>If you have errors when using mailman like this one:
<pre>
Group mismatch error. Mailman expected the mail wrapper script to be
executed as one of the following groups:
[mail, postfix, mailman, nobody, daemon],
but the system's mail server executed the mail script as group: "mailnull".
</pre>
This seems to be related to a sendmail bug. Then you should add this line in sendmail.cf:
<pre>O DefaultUser=root:mailman</pre>
  </li>

</ul>
<u>In /etc/mail/local-host-names:</u><br>
<ul>
  <li>Say that you are serving the various codendi sub-domains as follows:<br>
    <pre># local-host-names - include all aliases for your machine here.<br>codendi.xerox.com<br>lists.codendi.xerox.com<br>users.codendi.xerox.com<br></pre>
    <pre><br></pre>
  </li>
</ul>
<p>To check your configuration, you can try to send an email from the root account to an external email address. If the message comes back with this error:
<pre>(reason: 553 5.1.8 <root@localhost.localdomain>... Domain of sender address root@localhost.localdomain does not exist)
</pre>
It probably means that the machine host name is not properly configured. Try:
<pre>hostname atlas.codendi.xerox.com
service sendmail restart
</pre>
Or edit /etc/sysconfig/network and enter the machine fully qualified name as HOSTNAME.
<br><b>OR</b> edit /etc/hosts and add codendi.xerox.com in the first line. E.g.
<pre>127.0.0.1       codendi.xerox.com atlas localhost.localdomain localhost</pre>

<h2>Postfix settings</h2>
<p>It is possible to use Postfix as MTA, but this is not automated at the moment.
</br>If you would like to use postfix instead of sendmail, you first need to properly install this package:
<pre>
# Install RPM
yum install postfix
# Stop Sendmail if it is running
service sendmail stop
# Prevent sendmail from starting after a reboot
chkconfig sendmail off
# Make postfix start instead
chkconfig --add postfix
# Updating alternatives aliases
alternatives --set mta /usr/sbin/sendmail.postfix
# Starting Postfix service
service postfix restart
</pre>
<p>Then you should edit the postfix configuration file /etc/postfix/main.cf, and replace the value of these parameters:
<ul>
<li><a href="http://www.postfix.org/postconf.5.html#inet_interfaces">inet_interfaces</a> = all (instead of 'localhost' by default).</li>
<li><a href="http://www.postfix.org/postconf.5.html#myhostname">myhostname</a>    = my_server.my_domain.com </li>
<li><a href="http://www.postfix.org/postconf.5.html#mydomain">mydomain</a>      = my_domain.com </li>
<li><a href="http://www.postfix.org/postconf.5.html#alias_maps">alias_maps</a>    = hash:/etc/aliases, hash:/etc/aliases.codendi </li>
<li><a href="http://www.postfix.org/postconf.5.html#alias_database">alias_database</a>    = hash:/etc/aliases, hash:/etc/aliases.codendi </li>
<li><a href="http://www.postfix.org/postconf.5.html#mydestination">mydestination</a> = $myhostname, localhost.$mydomain, localhost, lists.$myhostname </li>
<li><a href="http://www.postfix.org/postconf.5.html#mynetworks">mynetworks</a>    = 127.0.0.1/8 xxx.xxx.xxx.xxx/xx </li>
</ul>
<br />The modification of <a href="http://www.postfix.org/postconf.5.html#mydestination">mydestination</a> is only needed when subdomains are enabled.
<br /><a href="http://www.postfix.org/postconf.5.html#mynetworks">mynetworks</a> allows to authorize any server from another network to send mail to the postfix instance
<br /><a href="http://www.postfix.org/postconf.5.html#relay_domains">relay_domains</a> may be checked if sending email to another domain is required, see also <a href="http://www.postfix.org/postconf.5.html#relay_transport">relay_transport</a>,<a href="http://www.postfix.org/postconf.5.html#relayhost">relayhost</a>.
<p>Last, you should customize the mailman configuration for postfix.
Simply add this at the end of /etc/mailman/mm_cfg.py
<pre>
MTA = 'Postfix'
POSTFIX_STYLE_VIRTUAL_DOMAINS = 'false'
</pre>
<p>Don't forget to restart mailman and postfix
<pre>
service postfix restart
service mailman restart
</pre>

<h2>Aliases</h2>
<u>/etc/aliases</u><br>
<br>
This is where you must insert system level aliases by hand (e.g.
aliases for postmaster, root, etc.). <br>
<br>
/<u>etc/aliases.codendi</u><br>
<br>
aliases.codendi is generated automatically bo the Codendi cron job (see
below) and contains the aliases for all the mailing lists in the
@lists.codendi.xerox.com domain and the email aliases for users. **Never
edit this file by hand**<br>
<br>
<h2>Sendmail shell wrappers</h2>
In the Codendi Configuration, sendmail uses a number of shell wrappers
used in pipe commands in the aliases file. These shell wrappers must be
explicitely delcared in the /etc/smrsh directory in order to execute
properly. You should create the following links:<br>
<br>
<pre>	# cd /etc/smrsh<br>	# ln -sf /usr/local/bin/gotohell<br>	# ln -sf /usr/lib/mailman/mail/mailman<br></pre>
<br>
<hr>
<h1><a name="Mailman_Installation_and_Configuration"></a>Mailman
Installation and Configuration</h1>
Codendi now uses a modified version of RedHat mailman RPMs.
Only the RPM SPEC file and mailman configuration files have been changed.
<br>
You need to setup a mailman admin password once the installation is done (we
recommend that you use the same password as the codendiadm account).
To
this end use the 'mmsitepass' script in /usr/lib/mailman/bin.<br>
<br>
You must also configure the Apache configuration <tt>httpd.conf</tt>
to
instruct Apache on how to access the Web based mailing manager and
archiver. A sample configuration file is provided with the RPM.<br>
<br>
Create a "site-wide" mailing list. This is the one that password
reminders will appear to come from.
<pre>    % bin/newlist mailman<br>    % bin/config_list -i data/sitelist.cfg mailman<br></pre>
Be sure to subscribe yourself to the site list
<pre>    % echo "your.email@address.com" | bin/add_members -r - mailman</pre>
Update /etc/aliases as precised, and remove existing mailman aliases if any. Then run 'newaliases'.
<br>
You must also override some Mailman variable settings, most notably set
the
DEFAULT_EMAIL_HOST and&nbsp; DEFAULT_URL_HOST to lists.codendi.xerox.com.
Look at their original
definition in <span style="font-family: monospace;">/usr/lib/mailman/Mailman/Defaults.py</span>
and redefine them in <span style="font-family: monospace;">/usr/lib/mailman/Mailman/mm_cfg.py.</span>
When you change either variable in your mm_cfg.py, then be sure to also
include the following:
<pre>     add_virtualhost(DEFAULT_URL_HOST, DEFAULT_EMAIL_HOST)<br></pre>
<p>
If you wish to run Mailman with HTTPS (secure server), you need to add two more lines to
 <span style="font-family: monospace;">/usr/lib/mailman/Mailman/mm_cfg.py.</span>:
<pre>
DEFAULT_URL_PATTERN = 'https://%s/mailman/'
PUBLIC_ARCHIVE_URL = 'https://%(hostname)s/pipermail/%(listname)s'
</pre>
See also <a href="http://www.python.org/cgi-bin/faqw-mm.py?req=show&file=faq04.027.htp">Mailman FAQ on this topic</a>.
<p>
Then recompile with python -O mm_cfg.py.<br>
<br>
<hr size="2" width="100%">
<h1><a name="Miscellaneous_Utilities"></a>Miscellaneous Utilities</h1>
There are a few utilities that must be either compiled and/or installed
in /usr/local/bin. A precompiled version of all these scripts is
provided at <a
 href="http://codendi.partners.xrce.xerox.com/packages/nonRPMS_Codendi/utilities">http://codendi.partners.xrce.xerox.com/packages/nonRPMS_Codendi/utilities</a>
<br>
<br>
<h2>fileforge</h2>
<p>This is a small utility which is called by the Apache server to move
files from the incoming ftp directory to the project file release space</p>
<p>Go to /usr/share/codendi/src/utils. In fileforge.c, modify the following
lines if need be </p>
<pre>  char * src_dir   = "/var/lib/codendi/ftp/incoming/"; /* the ftp incoming directory */<br>  char * dest_dir  = "/var/lib/codendi/ftp/codendi/"; /* the file release space for Codendi projects */<br></pre>
The trailing slashes are mandatory. Compile it with gcc -O2 -o
fileforge fileforge.c. Then copy fileforge to /usr/local/bin and run:
<pre>	# cd /usr/local/bin<br>	# chown root.codendiadm fileforge<br>	# chmod 4750 fileforge   # sets the uid bit<br><br></pre>
<p>Alternatively, use the compile_fileforge.sh script located in src/utils: it will perform all those steps for you.
<h2>gotohell</h2>
A simple shell script to discard all the messages sent to the
noreply@codendi.xerox.com messages. The file must contain:<br>
<br>
<blockquote>
  <pre>#!/bin/sh</pre>
  <pre>cat - &gt;/dev/null</pre>
</blockquote>
Ownership and permission must be:<br>
<pre>	-rwxr-xr-x&nbsp;&nbsp;&nbsp; 1 root&nbsp;&nbsp;&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 27 Dec 11&nbsp; 2001 /usr/lib/codendi/bin/gotohell</pre>
<br>
<br>
<hr style="width: 100%; height: 2px;">
<h1><a name="Subversion_Configuration"></a>Subversion Configuration</h1>
<ul>
  <li>First make sure the Codendi specific RPMs for Subversion are installed on
your Codendi server (see the section on <a
 href="#RPM_Packages">RPM
Packages</a>)</li>
  <li>Create the <tt>/var/lib/codendi/svnroot</tt> directory and the <tt>/svnroot</tt> link as
follows:<br>
    <br>
    <tt># mkdir /var/lib/codendi/svnroot<br>
# chown codendiadm.codendiadm /var/lib/codendi/svnroot</tt><tt><br>
# chmod 775 /svnroot</tt><tt><br>
# ln -s /var/lib/codendi/svnroot /svnroot</tt><br>
</li>
</ul>
Subversion offers several remote access methods either via the native
svnserve protocol or via the HTTP WebDAV subversion protocol. For many
reasons Codendi has opted for the HTTP WebDAV access through Apache 2.0.
The Apache virtual subversion servers are created automatically by the
Codendi cron job. If you have activated secure HTTP on your server then
you can also protect the HTTP authentication process by accessing your
Subversion repository via an HTTPS URL.<br>
<br>
<span style="font-weight: bold;"></span>
<hr>
<h1><a name="CVS_Configuration"></a>CVS Configuration</h1>
<ul>
  <li>First, make sure the Codendi specific RPMs for CVS are installed on
your Codendi server (see the section on <a href="#RPM_Packages">RPM
Packages</a>)</li>
  <li>Create the <tt>/etc/cvs_root_allow</tt> file as follows:<br>
    <br>
    <tt># touch /etc/cvs_root_allow<br>
# chown codendiadm.codendiadm /etc/cvs</tt><tt>_root</tt><tt>_allow<br>
# chmod 644 /etc/cvs</tt><tt>_root</tt><tt>_allow</tt></li>
</ul>
Then you have to decide what type of CVS access you want to offer to
your users: either through the standard pserver protocol,through
SSH
(secure shell), or, if you installed CVSNT instead of CVS, you may use the sserver protocol (SSL encrypted pserver).
If your site is inside your corporate network the
pserver method is a good choice. If your site is on the Internet we
recommend that you use the SSH or sserver approach to make sure that
confidential&nbsp; information like passwords or source code travels
encrypted.
<h2>The pserver approach</h2>
<ul>
  <li>Configure xinetd to start the cvs server when needed. The
/etc/xinetd.d/cvs file must look like this: <br>
    <tt>service cvspserver<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
disable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= no<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
socket_type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = stream<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
protocol&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= tcp<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
wait&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= no<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
user&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= root<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
= /usr/bin/cvs<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
server_args&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; = -f -z3
-T/var/tmp --allow-root-file=/etc/cvs_root_allow pserver<br>
}</tt></li>
</ul>
The benefit of using the pserver approach is that you can define who
has read and write permission on the CVS repository through the
CVSROOT/readers and CVSROOT/writers file of your CVS repository. In the
current implementation all project members are granted read and write
access to the CVS repository of the projects they belong to. &nbsp;You
can always add users' name in the CVSROOT/readers file to give them
read-only access.<br>
<h2>The sserver approach: CVSNT</h2>
<ul>
<li>First, you need to make sure that you use cvsnt and not cvs. Type 'cvs -v' to verify this. If not, install CVSNT from Codendi CD like this:

<pre>
rpm -ivh --nodeps cvsnt-2.5.04.3236-1.i386.rpm cvsnt-protocol-sserver-2.5.04.3236-1.i386.rpm
ln -s /lib/libcrypto.so.0.9.8e /lib/libcrypto.so.4
ln -s /lib/libssl.so.0.9.8e /lib/libssl.so.4
</pre>
The RPM provided by CVSNT relies on older libraries. This is why we need to 'force' the RPM installation without checking dependencies.

<li>You also need to verify that the sserver protocol is installed. Type 'cvs info'. this command should return a line like this one:
<pre>
sserver             sserver 2.5.04 (Zen) Build 3236 ()
</pre>
<li>Configure xinetd to start the cvs server when needed. The
/etc/xinetd.d/cvsnt file must look like this: <br>
<pre>
service cvspserver
{
       disable = no
       socket_type     = stream
       wait            = no
       user            = root
       group           = root
       log_type        = FILE /var/log/cvspserver
       server          = /usr/bin/cvsnt
       server_args     = -f -z3 -T/var/tmp authserver
       groups          = yes
       log_on_failure  += USERID
       mdns            = no # Lockserver handles mdns broadcast
} 
</pre>
You will need to restart xinetd:
<pre>
service xinetd restart

</pre>
<li>Make sure that there is no /etc/xinetd.d/cvs file that might interfere with this one. Don't rename the file, but move it somewhere else, or delete it.
<li>add the cvslockd service:
<pre>
chkconfig --add cvslockd
service cvslockd start
</pre>
<li>Copy '/usr/share/codendi/src/etc/PServer.dist' file to /etc/cvsnt/PServer.<br>
Note that the sserver protocol uses the same SSL certificates as the https protocol.
If your Codendi server is not yet configured for HTTPS, you need to generate a certificate.
<li>You may need to migrate existing CVSROOTs if they were created with CVS (and not CVSNT) with a script. Use /usr/share/codendi/src/utils/cvs1/cvs2cvsnt.pl.

</ul>
<h2>The SSH approach</h2>
The idea behind the SSH approach is that a client ssh to the remote
server and the cvs command is actually executed on the remote server.
Note that this is different from another approach which consist of
using
the port forwarding capability of SSH to encrypt all trafic on the TCP
port 2401 used by the pserver.<br>
<br>
There is no much to do to allow this method. The simple fact of having
the sshd daemon running will allow users to use this method. Things to
pay attention to:<br>
<ul>
  <li>If you want to disable the pserver access, make sure you edit
/etc/xinetd.d/cvs, change the 'disable' parameter to 'yes' and restart
xinetd (service xinetd restart)</li>
  <li>On the client side, &nbsp;users must set the environment variable
CVS_RSH to 'ssh'</li>
  <li>You must also copy the site-content/en_US/cvs/intro.txt in
site-content/custom/en_US/cvs/intro.txt and edit it to reflect the new
CVS access method.<br>
    <br>
  </li>
</ul>
See also the section on <a href="#RestrictedShell">restricted shells</a>.
<h2>The CVS Tracking Database</h2>
Codendi offers the ability for each project to build a database of all
CVS events (commit, add, delete) happening on their CVS repository.
This feature is activated in the CVS Web interface of the Codendi Web
frontend under CVS -&gt; Admin. For this feature to work properly
symbolic links must be created from the /usr/local/bin directory as
follows:<br>
<pre><tt>&nbsp;&nbsp;&nbsp; # cd /usr/share/codendi/src/utils/cvs1</tt><tt><br>&nbsp;&nbsp;&nbsp; # cp log_accum /usr/lib/codendi/bin<br>&nbsp;&nbsp;&nbsp; # cp commit_prep</tt><tt> /usr/lib/codendi/bin</tt></pre>
The log_accum script requires the
codendiadm group ownership to execute properly. <b><font
 color="#ff0000">**HIGHLY CRITICAL**</font></b>
<pre>	# cd /usr/lib/codendi/bin<br>	# chown codendiadm.codendiadm log_accum commit_prep<br>	# chmod 755 log_accum commit_prep<br>	# chmod u+s log_accum   # sets the uid bit (-rwsr-xr-x)<br></pre>
Be careful that you must set the uid bit again whenever the log_accum
script is updated from CVS and copied again into the /usr/lib/codendi/bin
directory.<br>
<tt><br>
</tt>
<h2>Browsing the CVS Trees</h2>
The ViewVC package is delivered as part of the Codendi software and
allows Codendi users to browse both CVS and Subversion repositories from
their Web browser. After installing the ViewVC RPM package (see&nbsp;<a
 href="#Installing_the_Codendi_Software">#Installing_the_Codendi_Software</a>
), a cgi-bin directory is created with the viewvc.cgi script in it.
The ViewVC configuration file is at <span
 style="font-family: monospace;">/etc/codendi/conf/viewvc.conf</span>.<br>
<br>
<hr>
<h1><a name="FTP_Configuration"></a>FTP Configuration</h1>
<ul>
  <li>Codendi FTP service is based on vsftpd, the FTP server distributed with Red Hat Enterprise Linux.</li>
  <li>Make sure the ftp service is enabled:<br>
    <tt>chkconfig vsftpd on</tt><br>
  </li>
  <li>The /etc/vsftpd/vsftpd.conf on the Codendi site must be edited to allow anonymous upload:<br>
    <tt>anon_upload_enable=YES</tt></li>
  <li>You may also customize the welcome banner.<tt><br>
ftpd_banner=Welcome to Codendi FTP service.
    </tt></li>
  <li>Last, you may also set welcome messages in various directories: /var/lib/codendi/ftp/.message for the main welcome message, and /var/lib/codendi/ftp/incoming/.message for the incoming directory. Make sure both files are owned by ftpadmin.</li>
</ul>
<hr>
<h1><a name="Shell_Account"></a>Shell Account</h1>
Unless otherwise instructed the Codendi system will create a shell
account for all users who have a Web account. The login and password
are
the same. Users can access their shell account either through SSH or
telnet. We will see how to restrict the use of a shell account below.
It
is also possible to suspend or delete a user account (both Web and
Unix) but be aware that disabling the Linux account will prevent users
from using all the peripheral services like CVS, FTP,... <br>
<h2>SSH Configuration</h2>
Simply check that the ssh daemon is started (command is 'service ssh
start'). Also make sure that it is started at boot time (command is
'chkconfig sshd on').
<h2>Telnet Configuration</h2>
Telnet access should only be enabled when your Codendi site is on a safe
network. If you are on the Internet we *strongly* recommend that you
disable it. To enable/disable the telnet access on your Codendi server,
edit the /etc/xinetd.d/telnet file and change the 'disable' parameter
accordingly. Then restart xinetd.<br>
<h2><a name="RestrictedShell">Restricted Shell Capabilities</h2>
It is sometimes desirable to allow the creation of a Shell Account for
Codendi users while limiting the thing they can do with it. For instance
you may want to limit the capabilities of certain users to use only CVS
and may be sftp if you decide to use the secure ftp server but you
don't
want them to log into the system with a real shell like bash. Doing so
is just a matter of changing the shell account associated with a given
user.<br>
<br>
By default the user table of the Codendi database has '/bin/bash'
configured as the default shell. When the user account is created by
the
cron job s/he will have /bin/bash as a shell and therefore s/he will be
given full shell capabilities. You can later decide to change the shell
of a given user through the user admin interface of the Codendi Web site
and use a restricted shell like the ones Codendi provide in
src/utils/cvs1/:
<ul>
<li><b>cvssh</b>: This is a little script that simply check the
command that are remotely executed through ssh by the user (it can be
cvs, sftp, rsync,...) and decide to accept or reject the command.
<li><b>cvssh-restricted</b>: works as cvssh, but prevents CVS access to
projects the user is not member of. This is the default shell for
Codendi restricted users (status 'R')
</ul>
<br>
<br>
To activate these pseudo shells:<br>
<ul>
  <li>copy the file cvssh (or cvssh-restricted) in /usr/lib/codendi/bin,
make sure it is executable and also add the file to the list of
authorized shells in /etc/shells. Adding cvssh to /etc/shells will make
it appear in the list of possible shells in the Codendi user admin
interface. Note: This is already done for you on Codendi versions after 2.4</li>
  <li>If you want the restricted shell to be the default for all users
then
change the default value of the shell column in the user table with the
following mysql command:<br>
    <pre>$ mysql -u codendiadm codendi -p<br>mysql&gt;&nbsp; ALTER TABLE user ALTER COLUMN shell SET DEFAULT<br>'/usr/lib/codendi/bin/cvssh' ;</pre>
  </li>
</ul>
<br>
<h2>No Shell Access</h2>
It is also possible to disable the shell access to all user by default.
The procedure is as follows:<br>
<ul>
  <li>Add '/bin/false' to the list of allowed shells in /etc/shells.</li>
  <li>If you want to deactivate shell access for all users by default
then
change the default value of the shell column in the user table with the
following mysql command:<br>
    <pre>$ mysql -u codendiadm codendi -p<br>mysql&gt;&nbsp; ALTER TABLE user ALTER COLUMN shell SET DEFAULT<br>'/bin/false' ;</pre>
  </li>
</ul>
Note: if you do this then you must use the pserver or sserver protocols to access
the cvs repository as the access through ssh requires a shell account
to be activated.<br>
<br>
<hr>
<h1><a name="Codendi_Site_Customization"></a>Codendi Site Customization</h1>
<h2>Codendi admin user</h2>
<font style="font-weight: bold;" color="#ff0000">**HIGHLY CRITICAL**</font><b><font
 color="#ff0000"><br>
</font></b>When you'll be initializing the Codendi database (see next
step below), the user table of the Codendi database is initialized with a
Codendi user called 'admin' who has full admin rights on all the Codendi
hosted projects and also has access to Web based administration modules
like user and project settings, project approval, software map
configuration,etc.<br>
<br>
The default password for the admin user is 'siteadmin' , we strongly
encourage you to change this password as soon as the site is up and
running. Here is how to do it:<br>
<ul>
  <li>login on the Web front end with user 'admin', password 'siteadmin'</li>
  <li>click on the 'Account Maintenance' &nbsp;link in the left hand
side menu pane</li>
  <li>click on change email address and update it either with your own
email address if you are the only administrator or first create a
distribution list with all the codendi admin email adresses and use this
mailing list address</li>
  <li>go back and change the password&nbsp;</li>
  <li>logout and login again to make sure that the new password was
taken into account</li>
</ul>
<h2><a name="System_configuration_file_local.inc"></a>System
configuration file (local.inc)</h2>
The PHP scripts take many values from a configuration file located in <span
 style="font-family: monospace;">/etc/codendi/conf/local.inc</span>. This
file must
be initially copied from the <span style="font-family: monospace;">src/etc/local.inc.dist</span>
file and the values must be changed accordingly for your site. Make
sure that you read this file where the role of each variable is well
documented.<br>
<h2 id="themes">UI Themes</h2>
The Codendi Web pages look and feel are defined through Cascading Style
Sheets (CSS). &nbsp;Therefore Codendi UI is customizable to large extent.
The Graphical user interface elements of Codendi come in the following
directory:
<dl>
	<dt><tt>src/www/themes/</tt></dt>
	<dd>
		<div>Each sub-directory in this place contains a given theme which name 
		is the sub-directory name. By default Codendi comes with the 'Codendi', 
		'CodendiTab' and 'savannah' themes. Each theme directory 
		contains a <tt>css</tt> directory and a <tt>images</tt> directory. 
		</div>
		<div>Each style directory contains 3 CSS files named 
		'<i>themename_fontsize</i>.css' where
		fontsize is one of 'large', 'normal' or 'small'. Files differ only by
		the size of the default font used in the Web pages. All 3 must be
		present because Codendi users can choose a prefered font size in her
		Account Maintenance page.
		</div>
		<div>Each images directory contains all the logos and images needed by 
		the Codendi Web pages.</div>
		<div>The theme must contain also a class named themename_Theme.class 
		which is responsible for the construction of the layout.</div>
	</dd>
</dl>
<div>
To have more information about themes, or about creation of new themes, please 
see the corresponding section in <a
 href="/documentation/programmer_guide/html/en_US/Codendi_Programmer_Guide.html">The Codendi Programmer's Guide</a>.</div>
<br>
<h2>Organization Logo</h2>
At the top of the left hand side Codendi menu pane (just above the Logged
In section) is an empty area where you can dock the logo of your
organization. This can be achieved by first creating your own theme
directory as explained in the previous section and then changing the
image named '<span style="font-family: monospace;">organization_logo.png</span>'.
By default this is a transparent image of size 52x52 pixels. We
recommend that your logo do not exceed 60x140 pixels to preserve the
nice looking layout of the menu bar.<br>
<h2><a name="Site_content"></a>Site content</h2>
Several PHP scripts in the Codendi source code contain pieces of text or code
that are generally here to give instructions to the Codendi users, or to provide 
site-specific information. Typical
examples are: the introductory text at the top of the Codendi Home Page,
instructions on how to connect to the CVS repository, instructions and
guidelines in the project registration process, LDAP repository information, etc.<br>
<br>
These pieces of text or code are isolated from the PHP scripts themselves and
they are all placed under the top directory <tt>'site-content'</tt>.
&nbsp;The file path to the content of a given script (or part of a
script) follows the following pattern:<br>
<br>
<tt>site-content/<i>LANG_COUNTRY</i>/<i>src_path</i>/<i>whattext</i>.txt</tt><br>
<br>
where:<br>
<ul>
  <li>LANG_COUNTRY is the standard ISO naming for language and
countries: Currently Codendi supports two languages: en_US (American English) and fr_FR (French).</li>
  <li>src_path is the name of the directory under src which contains the
script the text belongs to.</li>
  <li>whattext.txt is a file name that contains the piece of text itself<br>
  </li>
</ul>
By default the site-content directory should be stored in the same
place as the src directory (PHP scripts). &nbsp;Make sure you update the
<tt>$sys_incdir</tt>
variable in <tt>/etc/codendi/conf/local.inc</tt> to reflect the path to
the <tt>site-content</tt>
directory (default is <tt>/usr/share/codendi/site-content</tt>).<br>
<br>
To customize the content of a given script for your site go through the
following steps:<br>
<ol>
  <li>Under <span style="font-family: monospace;">/etc/codendi</span>
create the <span style="font-family: monospace;">site-content</span>
directory if it doesn't exist.</li>
  <li>For each piece of text that you want to customize copy the
original <tt><i>whattext</i>.txt</tt> file under the <tt>/etc/codendi/site-content/<i></i></tt>
with the exact same path. For instance if you want to customize the
introductory text of the Codendi home page, copy <span
 style="font-family: monospace;">/usr/share/codendi/site-content/en_US/homepage/welcome_intro.txt</span>&nbsp;
into and <span style="font-family: monospace;">/etc/site-content/en_US/homepage/welcome_intro.txt</span>
edit it as you like.<br>
    <br>
<u>Be careful that some of these files contain PHP scripting that you
probably want to preserve in your customized version. Deleting the PHP
scripting could break the entire PHP scripts. Ask the Codendi Team if you
are unsure of what you are doing.</u><br>
    <br>
  </li>
</ol>
Read also <a href="#localization">Localization</a> below for additional information on how to customize interface messages.
<h2><a name="localization"></a>Localization</h2>
<p>Codendi source code is localized, so the interface is displayed in the user-selected language.
Currently, Codendi supports the English and French languages.
<p>Messages are stored in the <a href="#Site_content">Site content</a> directory: there is one message file per service, with the same name as the service, ending with '.tab'.
<br>E.g. 'site-content/en_US/tracker/tracker.tab' contains all tracker messages in English.
<br>The format of the message files is very simple: one line per message, with the following format:<br>
<pre>   key1[tab]key2[tab]your message here</pre>
<p>As with other site-content files, you may customize the language files, so that you can change a few specific messages:
<ol><li>Copy the language file you need to customize from the /usr/share/codendi/site-content subdirectory to the corresponding subdirectory in /etc/codendi/site-content (see <a href="#Site_content">Site content</a> above)
<li>Remove all lines that you don't need to change, and only keep the lines you will modify.
<li>Change the messages
<li>Repeat the operation for all the languages you need to support on your Codendi server.
</ol>
<p>Codendi themes may also use additional messages that are not part of the main Codendi source code. These messages are directly stored in the theme directory, and they may be customized for local themes in /etc/codendi/themes/messages/<i>theme_name</i>/
<p>When looking for a message to display, Codendi will look successively in the following directories, stopping as soon as the message is found:
<ol><li>Theme-specific message file
<li>/etc/codendi/site-content/<i>user_lang</i> directory
<li>/usr/share/codendi/site-content/<i>user_lang</i> directory
<li>/usr/share/codendi/site-content/en_US directory (if the message file does not exist in the selected language)
</ol>

<h2>Site Documentation</h2>
Codendi has an entry called 'Site Documentation' &nbsp;in the left hand
side menu. This menu entry actually points to the Document Manager of
the Codendi project ('Admin Project'). &nbsp;This project is
automatically defined when the Codendi database is initialized. It comes
with group_id 1 (ONE) and you can acces it at
http://your.codendi_site.url/projects/codendi.<br>
<br>
All documents stored in the document manager of the 'Admin Project'
will automatically appear under 'Site Documentation' (except those
with restricted access. See the <a
 href="/doc/en/user-guide/doc.html">Codendi
User Guide</a> for more details on the Document Manager service.<br>
<br>
<h2>User Guide and On-line Help <br>
</h2>
'On-line Help' is also a menu entry appearing in the left hand side
menu of Codendi. It actually points to the HTML version of the Codendi User
Guide (CUG). The CUG has been written in XML with the DocBook DTD and
is
stored under the top level '<tt>documentation</tt>' directory in the
Codendi source repository. To activate the on-line help simply check out the
<tt>documentation</tt> directory
at the same place as the <tt>src</tt> and <tt>site-content</tt>
directories.<br>
<font style="font-weight: bold;" color="#ff0000"><br>
**IMPORTANT REMARK**</font><br>
The User Guide contain references to the company name, server name
running Codendi,etc. These pieces of information vary from one site to
another. Therefore a specific file has been introduced at <span
 style="font-family: monospace;">/usr/share/codendi/documentation/user_guide/xml/ParametersLocal.dtd</span>
that you can use to customize the&nbsp; content of the Codendi User
Guide. To do so:<br>
<ul>
  <li>Copy <span style="font-family: monospace;">/usr/share/codendi/documentation/user_guide/xml/ParametersLocal.dtd
to </span><span style="font-family: monospace;"><span
 style="font-family: monospace;">/etc/codendi/documentation/user_guide/xml/ParametersLocal.dtd</span></span></li>
  <li>Edit the file you just copied and redefine the XML entities that
govern
the site specific information. For a list of the available XML entities
that you can redefine see the <span style="font-family: monospace;"><span
 style="font-family: monospace;">/usr/share/codendi/documentation/user_guide/xml/en_US/</span></span><span
 style="font-family: monospace;">ParametersDefault.dtd</span> . <br>
  </li>
  <li>Regenerate the documentation by running <span
 style="font-family: monospace;">the script
/usr/share/codendi/src/utils/generate_doc.sh</span></li>
</ul>
<br>
Also notice that the HTML and PDF versions of the CUG are <b>not</b>
stored in the source repository. They are generated from the XML files
using the script&nbsp; <span style="font-family: monospace;">/usr/share/codendi/src/utils/generate_doc.sh</span>.
You can run this
script
by hand from the codendiadm Linux account and our advice is also to
include it in the codendiadm crontab so that it runs once a day and
automatically regenerate the documentation when needed.<br>
<br>
For the script to work properly you must have the JRE (Java Runtime
Environment) and the DocBook processing chain installed properly. See
the section about <a href="#Specific_Software_Packages">specific
software packages to install</a>.<br>
<h2>Project Web Site</h2>
When a project is registered on Codendi a new web site is created for
that project. A default home page is installed for that project from
the <span style="font-family: monospace;">/usr/share/codendi/site-content/en_US/others/default_page.php</span>
file. You may want to create your own custom
file for your own Codendi site. To do so, copy the <span style="font-family: monospace;">
/usr/share/codendi/site-content/en_US/others/default_page.php</span> file
in the <span style="font-family: monospace;">/etc/codendi/site-content/en_US/others/</span>
directory if not already
there. Then, edit the custom file and customize it to your liking<br>
<hr>
<h1>LDAP Authentication and Querying</h1>
<p><b>NOTE: LDAP settings have changed in Codendi 2.8.</b>
<br><b>This documentation is only valid for Codendi 2.6.</b>
<h2>LDAP information from the company directory</h2>
<p>
While visiting a user information page on Codendi, you have the ability
to query the LDAP directory of your company to get more information
about this user.&nbsp; The following variables in the local.inc
configuration file (see <a href="#System_configuration_file_local.inc">above</a>)
allow you to customize the LDAP search:<br>
<ul>
  <li><span style="font-family: monospace;">$sys_ldap_server</span>:
the full name of the LDAP server to query (ask your system
administrator if you don't know of any around you). You may specify
multiple directories or mirrors by using a comma separated list of servers.</li>
  <li><span style="font-family: monospace;">$sys_ldap_dn</span>: the
distinguished name (DN) to use in the LDAP query (Remark: the LDAP
query in Codendi uses the user email address as the search key)</li>
  <li><span style="font-family: monospace;">$sys_ldap_filter:</span>
the search filter to use when a query is sent to the LDAP server. This
is the filter argument used in the ldap_search call. Any pattern of the
form %name% in the search filter will be replaced with the
corresponding value from the user table before ldap_search is called.
As an example <span style="font-family: monospace;">%email%</span>
will be replaced by the user email, <span
 style="font-family: monospace;">%user_name%</span> means the user
login name,etc...</li>
<li><span style="font-family: monospace;">$sys_ldap_bind_dn</span> and <span style="font-family: monospace;">$sys_ldap_bind_passwd</span> need only to be defined if the LDAP server does not allow anonymous binding. In such a case, please specify an LDAP distinguished name (DN) and password to use when querying or searching the directory.
</ul>
It is also possible to customize the HTML output of the LDAP search
when one accesses the information about a user on Codendi. You must edit
the script <span style="font-family: monospace;">site-content/<span
 style="font-style: italic;">LANG_COUNTRY</span>/include/user_home.txt</span>
to customize the HTML output and save it in the corresponding custom
directory (see <a href="#Site_content">Site Content</a> section above).<br>
<h2>LDAP Authentication</h2>
<p>
Codendi also supports LDAP authentication: passwords are no longer Codendi specific, but are managed in an external LDAP directory (e.g. the company directory).
<p><strong>Please note:</strong> as of Codendi 2.4, LDAP authentication is still experimental. <strong>Use with caution</strong>.
<h3>Specifications</h3>
<p>Codendi now supports LDAP authentication. In order to use this authentication scheme, set <span style="font-family: monospace;">$sys_auth_type</span> to 'ldap' and define the other variables in local.inc as specified below.
<p>The LDAP login and the Codendi login might not be the same. The reason for this is that the LDAP logins might not be compatible with UNIX logins (e.g. they might contain spaces, accentuated characters, etc.). In this case, the users will have two logins.
<ul><li> The web authentication login is the LDAP login: it is used to access the web-based user interface of Codendi. 
<li>Some services need a unix-based authentication, namely: CVS (with pserver, sserver or SSH), Subversion, FTP and shell access, and thus rely on the Codendi login.
</ul>
<p>Note that both logins use the same password, i.e. the LDAP password.
<h4>Registration</h4>
The registration phase is made up of two phases:
<ul><li>On the first screen, simply type your LDAP login and password.
<li>If the information was correct, the second screen displays the final registration form. Most fields are already defined, based on the LDAP directory information: email address, real name, unix login (currently based on email address).
</ul>
Fill the remaining blank fields and press the submit button. Your account is created!
<br> Note that if account creation needs approval, the account is not immediately available.
<h4>Login</h4>
<p>
When logging on the Codendi web interface, simply enter your LDAP name and password. The system will dynamically check your password against the LDAP server.
<p>If the LDAP password is different from the current Codendi password (used for Unix services: CVS, etc.), then the Codendi password is updated with the LDAP password. This is to ensure that the two logins always use the same password.
<h3>LDAP authentication setup</h3>
<p>In order to activate Codendi LDAP authentication, one only has to modify the local.inc configuration file (see <a href="#System_configuration_file_local.inc">above</a>).
<ul><li><span style="font-family: monospace;">$sys_ldap_server</span> is the full name of the LDAP server(s). You may specify
multiple directories or mirrors by using a comma separated list of servers. To specify secure LDAP servers, use 'ldaps://servername'. This variable is already defined above for querying LDAP information from the company directory.
<li><span style="font-family: monospace;">$sys_ldap_bind_dn</span> and <span style="font-family: monospace;">$sys_ldap_bind_passwd</span> may also be necessary depending on your LDAP setup (see above).
<li><span style="font-family: monospace;">$sys_auth_type</span> defines the authentication scheme to use. Its default value is 'codendi' for Codendi specific login/passwords. In order to use LDAP authentication, set this variable to 'ldap'.
<li><span style="font-family: monospace;">$sys_ldap_auth_dn</span> is the distinguished name (DN) used for checking the user LDAP name and password. 
<ul><li>If you already know the correct DN to use for your LDAP repository, please use <span style="font-family: monospace;">'%ldap_name%'</span> wherever the user LDAP login should appear in this DN. It will automatically be replaced by the login name entered by the user. In order to test the user credentials, the system will perform an LDAP bind with this DN and the user entered password. 
<br>Example: <span style="font-family: monospace;">$sys_ldap_auth_dn = 'dc=xerox, dc=com, cn=%ldap_name%'</span>.
<li> If you don't know the DN to use, you probably need a two-step authentication: an initial LDAP query with the first DN defined here and the filter defined below (<span style="font-family: monospace;">$sys_ldap_auth_filter</span>) will return the actual DN to use for authentication. Then a bind with the correct DN will be performed to test the credentials of the user. In this latter case, the string <span style="font-family: monospace;">'%ldap_name%'</span> should <b>not</b> appear in this variable, and you should probably have: <span style="font-family: monospace;">$sys_ldap_auth_dn</span> == <span style="font-family: monospace;">$sys_ldap_dn</span>. 
<br>Example: <span style="font-family: monospace;">$sys_ldap_auth_dn = 'o=XEROX, c=US'</span>.
</ul>
<li><span style="font-family: monospace;">$sys_ldap_auth_filter</span> defines the query filter to use for authentication-related LDAP queries. This variable <b>must</b> contain the <span style="font-family: monospace;">'%ldap_name%'</span> string, that will be replaced automatically by the user LDAP login. <br>Example: <span style="font-family: monospace;">$sys_ldap_auth_filter = 'uid=%ldap_name%'</span>.
<br>It is used in two places:
<ul><li>First, when a new user registers in Codendi, she needs to enter her LDAP login name. The system will then query the LDAP directory for additional information about this person (email address, real name, etc.). <span style="font-family: monospace;">$sys_ldap_auth_filter</span> is the filter used in this query.
<li>When a two-step LDAP authentication is in place (see above), this filter is used in the initial LDAP query run to extract the user DN needed for the authentication.
</ul>
</ul>
<h2>Example LDAP settings</h2>

<h3>Active Directory</h3>
<pre>
// Should be either 'ldap' or 'codendi'
$sys_auth_type = 'ldap';

$sys_ldap_server = 'ldapserver.mycompany.com';

// To enable LDAP information on Codendi users, also define the DN 
// (distinguised name) to use in LDAP queries.
// The ldap filter is the filter to use to query the LDAP directory
// (%name% are substituted with the value from the user table)
$sys_ldap_dn     = 'DC=mygroup,DC=mycompany,DC=com';
$sys_ldap_filter = 'sAMAccountName=%ldap_name%';

// For LDAP systems that do not accept anonymous binding, define here
// a valid DN and password:
$sys_ldap_bind_dn = "AD-DOMAIN\special_login";
$sys_ldap_bind_passwd = "xxxxx";

// LDAP authentication:
$sys_ldap_auth_dn     = 'DC=mygroup,DC=mycompany,DC=com';
$sys_ldap_auth_filter = 'sAMAccountName=%ldap_name%';

$sys_ldap_search_user='(|(sAMAccountName=%words%)(cn=%words%)(mail=%words%))';
$sys_ldap_eduid_filter='sAMAccountName=%eduid%';

$sys_ldap_eduid = 'samaccountname';   
$sys_ldap_cn    = 'cn';
$sys_ldap_mail  = 'mail';
$sys_ldap_login = 'samaccountname';
</pre>

<h3>OpenLDAP</h3>

<pre>
// Should be either 'ldap' or 'codendi'
$sys_auth_type = 'ldap';

$sys_ldap_server = 'myldapserver';

// To enable LDAP information on CodeX users, also define the DN
// (distinguised name) to use in LDAP queries.
// The ldap filter is the filter to use to query the LDAP directory
// (%name% are substituted with the value from the user table)
$sys_ldap_dn     = 'DC=mygroup,DC=mycompany,DC=com';
$sys_ldap_filter = 'mail=%email%';

// For LDAP systems that do not accept anonymous binding, define here
// a valid DN and password:
//$sys_ldap_bind_dn = "ldapsearch";
//$sys_ldap_bind_passwd = "xxxxxxxxx";

// LDAP authentication:
$sys_ldap_auth_dn = 'uid=%ldap_name%,ou=People,dc=mygroup,dc=mycompany,dc=com';
$sys_ldap_auth_filter = 'uid=%ldap_name%';

$sys_ldap_search_user='(|(uid=%words%)(cn=%words%)(mail=%words%))';
$sys_ldap_eduid_filter='uid=%eduid%';

$sys_ldap_eduid = 'uid';
$sys_ldap_cn    = 'displayname';
$sys_ldap_mail  = 'mail';
$sys_ldap_login = 'uid';

</pre>
<hr>
<h1><a name="Backend_Scripts"></a>Backend Scripts<br>
</h1>
Most of the backend scripts used by the Codendi system are writen in Perl
and are located in <tt>/usr/share/codendi/src/utils</tt>. Many of these script
use the<tt> include.pl</tt> file and, in case you did not follow the
standard installation process explained in this document, you may have
to customize the content of this include file to match your site
configuration.<br>
<br>
<hr>
<h1><a name="Cron_Jobs"></a>Cron Jobs</h1>
Codendi runs a number of cron job in the background. The most important
one is run once every 30 minutes on the Codendi site to check the mapping of
user/project permission to the Linux user/group permission mechanism.
it also checks that all the user and project related directories are properly created.<br>
<br>
Other cron jobs run daily and weekly statistics.<br>
<br>
<h2>Root crontab</h2>
Find below a copy of the root crontab file. we highly recommend that
you keep the same time and frequency to run the jobs. <br>
<br>
<blockquote>
  <tt># Once a minute, process Codendi system events</tt><br>
  <tt>* * * * * (cd /usr/share/codendi/src/utils; ./php-launcher.sh ./process_system_events.php)</tt><br>
  <tt>#</tt><br>
  <tt># Regularly launch a system_check event (e.g. every half-hour) </tt><br>
  <tt>0,30 * * * * (cd /usr/share/codendi/src/utils; ./php-launcher.sh ./launch_system_check.php)</tt><br>
  <tt>#</tt><br>
  <tt># run the daily statistics script just a little bit after</tt><br>
  <tt># midnight so that it computes stats for the day before</tt><br>
  <tt># Run at 0:30 am</tt><br>
  <tt>30 0 * * * /usr/share/codendi/src/utils/compute_all_daily_stats.sh</tt><br>
  <tt>#</tt><br>
  <tt># run the weekly stats for projects. Run it on Monday morning so
that</tt><br>
  <tt># it computes the stats for the week before</tt><br>
  <tt># Run on Monday at 1am</tt><br>
  <tt>0 1 * * Mon (cd /usr/share/codendi/src/utils/underworld-root;
./db_project_weekly_metric</tt><tt>.pl)</tt><br>
  <tt># daily incremental backup of subversion repositories</tt><br>
  <tt>45 23 * * 1-6 /usr/lib/codendi/bin/backup_subversion.sh -i</tt><br>
  <tt>#</tt><br>
  <tt># weekly full backup of subversion repositories (0:15 on Sunday)</tt><br>
  <tt>15 0 * * Sun /usr/lib/codendi/bin/backup_subversion.sh</tt><br>
  <tt>#</tt><br>
  <tt># weekly backup preparation (mysql shutdown, file dump and restart)</tt><br>
  <tt>45 0 * * Sun /usr/lib/codendi/bin/backup_job</tt><br>
  <tt>#</tt><br>
  <tt># Delete all files in FTP incoming that are older than 2 weeks
(336 hours)</tt><br>
  <tt>#</tt><br>
  <tt>0 3 * * * /usr/sbin/tmpwatch -m -f 336 /var/lib/codendi/ftp/incoming</tt><br>
  <tt>#</tt><br>
  <br>
</blockquote>
Please note that your own root crontab should probably contain some
additional jobs like may be stopping the mysql engine before starting
your backup procedure or something similar.<br>
<h2>Codendiadm crontab</h2>
<blockquote>
  <tt># Daily Codendi PHP cron (obsolete documents...)</tt><br>
  <tt>10 0 * * * /usr/share/codendi/src/utils/php-launcher.sh /usr/share/codendi/src/utils/codendi_daily.php</tt><br>
  <tt># Re-generate the Codendi User Guides on a daily basis</tt><br>
  <tt>00 03 * * * /usr/share/codendi/src/utils/generate_doc.sh</tt><br>
  <tt>30 03 * * * /usr/share/codendi/src/utils/generate_programmer_doc.sh</tt><br>
  <tt>45 03 * * * /usr/share/codendi/src/utils/generate_cli_package.sh</tt><br>
  <br>
</blockquote>
<br>
<hr>
<h1><a name="Log_Files_Rotation"></a>Log Files Rotation</h1>
In order to maintain statistics on http and ftp traffic the Codendi
server must be instructed to rotate the apache and ftp log files on a
daily basis.<br>
<h2>Apache Log File Rotation</h2>
<span style="font-family: monospace;">/etc/logrotate.d/apache </span>looks
like this:<br>
<br>
<span style="font-family: monospace;">/var/log/httpd/access_log {</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; missingok</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # LJ</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; daily</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; rotate 4</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; postrotate</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/usr/bin/killall -HUP httpd 2&gt; /dev/null || true</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# LJ Added for Codendi archiving</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
year=`date +%Y`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
month=`date +%m`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
day=`date +%d`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
destdir="/var/log/codendi/$year/$month"</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
destfile="http_combined_$year$month$day.log"</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; mkdir -p
$destdir</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; cp
/var/log/httpd/access_log.1 $destdir/$destfile</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; endscript</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">}</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">/var/log/httpd/vhosts-access_log {</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; missingok</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # LJ</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; daily</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; rotate 4</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; postrotate</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/usr/bin/killall -HUP httpd 2&gt; /dev/null || true</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
# LJ Added for Codendi archiving</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
year=`date +%Y`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
month=`date +%m`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
day=`date +%d`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
server=`hostname`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
destdir="/var/log/codendi/$server/$year/$month"</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
destfile="vhosts-access_$year$month$day.log"</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; mkdir -p
$destdir</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; cp
/var/log/httpd/vhosts-access_log.1 $destdir/$destfile</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; endscript</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">}</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><br style="font-family: monospace;">
<span style="font-family: monospace;">/var/log/httpd/agent_log {</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; missingok</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # LJ</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; daily</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; rotate 4</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; postrotate</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/usr/bin/killall -HUP httpd 2&gt; /dev/null || true</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; endscript</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">}</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><br style="font-family: monospace;">
<span style="font-family: monospace;">/var/log/httpd/error_log {</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; missingok</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # LJ</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; daily</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; rotate 4</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; postrotate</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/usr/bin/killall -HUP httpd 2&gt; /dev/null || true</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; endscript</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">}</span><br
 style="font-family: monospace;">
<br style="font-family: monospace;">
<span style="font-family: monospace;">/var/log/httpd/referer_log {</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; missingok</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # LJ</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; daily</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; rotate 4</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; postrotate</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/usr/bin/killall -HUP httpd 2&gt; /dev/null || true</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; endscript</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">}</span><br>
<br>
<h2>FTP log file rotation</h2>
<span style="font-family: monospace;">/etc/logrotate.d/ftpd </span>looks
like this:<br>
<br>
/<span style="font-family: monospace;">var/log/xferlog {</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # ftpd doesn't
handle SIGHUP properly</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; nocompress</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; # LJ Modified
for codendi</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; daily</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; postrotate</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
year=`date +%Y`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
month=`date +%m`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
day=`date +%d`</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
destdir="/var/log/codendi/$year/$month"</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
destfile="ftp_xferlog_$year$month$day.log"</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; mkdir -p
$destdir</span><br style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp; cp
/var/log/xferlog.1 $destdir/$destfile</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; endscript</span><span
 style="font-family: monospace;"></span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">}</span><br>
<br>
<br>
<hr>
<h1><a name="Installing_phpMyAdmin"></a>Installing phpMyAdmin<br>
</h1>
phpMyAdmin is a Web based GUI to manage MySQL database. Although
installing phpMyAdmin is not mandatory it is a very convenient for a
Codendi site adminstrator.<br>
phpMyAdmin is now provided with Codendi as a customized RPM package.
<br>
When you access the phpMyAdmin GUI at
http://<span style="font-style: italic;">your.codendi.domain</span>/phpMyAdmin
you'll be prompted for a
user name and password. Use the MySQL 'codendiadm' login and password.
<br>

<hr>
<h1><a name="Eclipse_plugin"></a>Eclipse plugin<br>
</h1>
<p>Codendi provides a plugin for Eclipse to allow access to Codendi trackers
directly from the IDE interface. This plugin is provided as a rpm (named codendi-eclipse),
that needs to be installed on the Codendi server. You also need to activate the plugin
from the Codendi plugin administration interface.
<br>Please read the Codendi User Guide for more information on how to setup
the Eclipse plugin.

<hr>
<h1><a name="Salome_plugin"></a>SaloméTMF plugin<br>
</h1>
<p>Codendi provides a test plan manager called SaloméTMF. This is a
Java application that must be downloaded by the end user with Java Web Start.
<br>In order to provide this service, you need to install a dedicated RPM (codendi-salome).
You also need to activate the plugin from the Codendi plugin administration interface,
and activate the service for each project that would like to use the service.
<p>
Please read the Codendi User Guide for more information on how to run Salomé from Codendi.
<p>
Please note that Salomé uses its own database (called 'salome'), with its own administrator (salomeadm).
<p>
The current implementation of Salomé needs a direct JDBC access from the client machine (the Java application) 
to the server database. Make sure that your firewalls do not forbid access to the JDBC port (3306).
<hr>
<h1><a name="Salome_plugin"></a>Instant Messaging<br>
</h1>
<p>Codendi hosts an Instant Messaging server based on the Jabber/XMPP protocol to provide instant messaging.
This server is the java-based <a href="http://www.igniterealtime.org/projects/openfire/index.jsp">OpenFire</a> server.
<br>Please note that OpenFire uses its own database (openfire), with its own administrator ('openfireadm').
The openfireadm MySQL user also needs read access to the user, group and user_group tables of the main database ('codendi').
<br>
You can access the <a href="../JabbeXInstallGuide.odt">detailed installation guide: JabbeXInstallGuide.odt</a> (OpenOffice odt format).

<hr>
<h1><a name="First_Things_To_Do_to_run_the_site"></a>First Things To Do
to run the site</h1>
<ul>
  <li>Access the Codendi server and login as admin with default password
siteadmin. Then change the password immediately. We suggest that you
use the same as the root password on the Linux side</li>
  <li>Logout and create your own account on the Codendi site: click on
'New User' and fill out the form. Wait for the email notification to
arrive and confirm the registration. If the mail doesn't work yet then
login as 'admin' again and force User registration approval in 'Main
Page' of the Site Administration menu.</li>
  <li>Login again as user 'admin' and make your own account a project
member of the Admin Project (group_id=1) so that you are considered as
a super user on the entire site. Set permissions for this new account.<br>
  </li>
  <li>Create the trackers you need (bug and support requests most
likely)</li>
  <li>From your own account create a new project 'Guinea Pig'
(shortname: gpig) that you will use as a test project for anybody
who wants to experiment with the site. Setup the project completely,
approve it and then set up the CVS or SVN repository with some sample code,
create a release, download it,etc...</li>
  <li>Under the 'Codendi Project' create a piece of news to announce the
launch of the Codendi site and promote the news to the front page.<br>
  </li>
</ul>
<br>
<hr width="100%" size="2" noshade="noshade"> End of Document<br>
</body>
</html>
