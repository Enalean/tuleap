<script type="text/ng-template" id="field-fieldset.tpl.html">
<fieldset
    class="tlp-pane tlp-pane-collapsable"
    ng-class="{ 'tlp-pane-collapsed': field.collapsed, 'tlp-pane-hidden': field.is_hidden }"
    data-test="fieldset"
>
    <div class="tlp-pane-container">
        <legend class="tlp-pane-header" ng-click="modal.toggleFieldset(field)">
            <h1 class="tlp-pane-title" data-test="fieldset-label">
                <i class="tlp-pane-title-icon fa fa-fw" ng-class="{ 'fa-caret-right': field.collapsed, 'fa-caret-down': ! field.collapsed }"></i>
                {{ field.label }}
            </h1>
        </legend>
        <section class="tlp-pane-section" data-test="fieldset-content">
            <ng-include
                src="field.template_url"
                ng-repeat="field in field.content"
            ></ng-include>
        </section>
    </div>
</fieldset>
</script>

<script type="text/ng-template" id="field-column.tpl.html">
<ng-include
    src="field.template_url"
    ng-repeat="field in field.content"
></ng-include>
</script>

<script type="text/ng-template" id="field-linebreak.tpl.html">
<br>
</script>

<script type="text/ng-template" id="field-separator.tpl.html">
<hr>
</script>

<script type="text/ng-template" id="field-staticrichtext.tpl.html">
<div class="tlp-property">
    <div ng-bind-html="modal.values[field.field_id].default_value"></div>
</div>
</script>

<script type="text/ng-template" id="field-sb.tpl.html">
<tuleap-artifact-modal-select-box-field
    controller="modal.getSelectBoxFieldController(field)"
    data-test="selectbox-field"
    ce-one-way
></tuleap-artifact-modal-select-box-field>
</script>

<script type="text/ng-template" id="field-msb.tpl.html">
<tuleap-artifact-modal-select-box-field
    controller="modal.getSelectBoxFieldController(field)"
    data-test="multi-selectbox-field"
    ce-one-way
></tuleap-artifact-modal-select-box-field>
</script>

<script type="text/ng-template" id="field-rb.tpl.html">
<tuleap-artifact-modal-radio-buttons-field
    field-id="field.field_id"
    name="field.name"
    label="field.label"
    required="field.required"
    disabled="modal.isDisabled(field)"
    value="modal.values[field.field_id].bind_value_ids[0]"
    values="field.values"
    on-value-changed="modal.setFieldValueForRadioButtonsCustomElement($event)"
    ce-one-way
    data-test="radiobutton-field"
></tuleap-artifact-modal-radio-buttons-field>
</script>

<script type="text/ng-template" id="field-cb.tpl.html">
<tuleap-artifact-modal-checkbox-field
    controller="modal.getCheckboxFieldController(field)"
    data-test="checkbox-field"
    ce-one-way
></tuleap-artifact-modal-checkbox-field>
</script>

<script type="text/ng-template" id="field-int.tpl.html">
<tuleap-artifact-modal-int-field
    field-id="field.field_id"
    label="field.label"
    required="field.required"
    disabled="modal.isDisabled(field)"
    value="modal.values[field.field_id].value"
    on-value-changed="modal.setFieldValueForCustomElement($event)"
    ce-one-way
    data-test="int-field"
></tuleap-artifact-modal-int-field>
</script>

<script type="text/ng-template" id="field-string.tpl.html">
<tuleap-artifact-modal-string-field
    field-id="field.field_id"
    label="field.label"
    required="field.required"
    disabled="modal.isDisabled(field)"
    value="modal.values[field.field_id].value"
    on-value-changed="modal.setFieldValueForCustomElement($event)"
    ce-one-way
    data-test="string-field"
></tuleap-artifact-modal-string-field>
</script>

<script type="text/ng-template" id="field-float.tpl.html">
<tuleap-artifact-modal-float-field
    field-id="field.field_id"
    label="field.label"
    required="field.required"
    disabled="modal.isDisabled(field)"
    value="modal.values[field.field_id].value"
    on-value-changed="modal.setFieldValueForCustomElement($event)"
    ce-one-way
    data-test="float-field"
></tuleap-artifact-modal-float-field>
</script>

<script type="text/ng-template" id="field-text.tpl.html">
<tuleap-artifact-modal-text-field
    field-id="field.field_id"
    label="field.label"
    format="modal.values[field.field_id].value.format"
    content-value="modal.values[field.field_id].value.content"
    required="field.required"
    disabled="modal.isDisabled(field)"
    controller="modal.getFormattedTextController()"
    on-value-changed="modal.setFieldValueForCustomElement($event)"
    ce-one-way
    data-test="text-field"
></tuleap-artifact-modal-text-field>
</script>

<script type="text/ng-template" id="field-art_link.tpl.html">
<tuleap-tracker-link-field
    controller="modal.getLinkFieldController(field)"
    autocompleter="modal.getLinkFieldAutoCompleter()"
    creator-controller="modal.getArtifactCreatorController()"
    on-change="modal.linkFieldChanged()"
    ce-one-way
></tuleap-tracker-link-field>
</script>

<script type="text/ng-template" id="field-burndown.tpl.html">
<tuleap-artifact-modal-burndown-field
    field="field"
    current-artifact-identifier="modal.current_artifact_identifier"
    ce-one-way
></tuleap-artifact-modal-burndown-field>
</script>

<script type="text/ng-template" id="field-cross.tpl.html">
<tuleap-artifact-modal-cross-references-field
    field="field"
    ce-one-way
></tuleap-artifact-modal-cross-references-field>
</script>

<script type="text/ng-template" id="field-aid.tpl.html">
<tuleap-artifact-modal-artifact-id-field
    field="field"
    current-artifact-identifier="modal.current_artifact_identifier"
    ce-one-way
></tuleap-artifact-modal-artifact-id-field>
</script>

<script type="text/ng-template" id="field-atid.tpl.html">
<tuleap-artifact-modal-artifact-id-field
    field="field"
    current-artifact-identifier="modal.current_artifact_identifier"
    ce-one-way
></tuleap-artifact-modal-artifact-id-field>
</script>

<script type="text/ng-template" id="field-priority.tpl.html">
<tuleap-artifact-modal-priority-field
    field="field"
    ce-one-way
></tuleap-artifact-modal-priority-field>
</script>

<script type="text/ng-template" id="field-computed.tpl.html">
<tuleap-artifact-modal-computed-field
    field-id="field.field_id"
    label="field.label"
    required="field.required"
    disabled="modal.isDisabled(field)"
    value="field.value"
    manual-value="modal.values[field.field_id].manual_value"
    autocomputed="modal.values[field.field_id].is_autocomputed"
    on-value-changed="modal.setFieldValueForComputedFieldElement($event)"
    ce-one-way
    data-test="computed-field"
></tuleap-artifact-modal-computed-field>
</script>

<script type="text/ng-template" id="field-subby.tpl.html">
<tuleap-artifact-modal-user-avatar-field
    field="field"
    ce-one-way
></tuleap-artifact-modal-user-avatar-field>
</script>

<script type="text/ng-template" id="field-luby.tpl.html">
<tuleap-artifact-modal-user-avatar-field
    field="field"
    ce-one-way
></tuleap-artifact-modal-user-avatar-field>
</script>

<script type="text/ng-template" id="field-subon.tpl.html">
<tuleap-artifact-modal-date-readonly-field
    field="field"
    formatter="modal.readonly_date_field_formatter"
    ce-one-way
></tuleap-artifact-modal-date-readonly-field>
</script>

<script type="text/ng-template" id="field-lud.tpl.html">
<tuleap-artifact-modal-date-readonly-field
    field="field"
    formatter="modal.readonly_date_field_formatter"
    ce-one-way
></tuleap-artifact-modal-date-readonly-field>
</script>

<script type="text/ng-template" id="field-file.tpl.html">
<tuleap-artifact-modal-file-field
    field="field"
    controller="modal.getFileFieldController(field)"
    disabled="modal.isDisabled(field)"
    data-test="file-field"
    ce-one-way
></tuleap-artifact-modal-file-field>
</script>

<script type="text/ng-template" id="field-perm.tpl.html">
<tuleap-artifact-modal-permission-field
    controller="modal.getPermissionFieldController(field)"
    data-test="permission-field"
    ce-one-way
></tuleap-artifact-modal-permission-field>
</script>

<script type="text/ng-template" id="field-date.tpl.html">
<tuleap-artifact-modal-date-field
    field="field"
    is-disabled="modal.isDisabled(field)"
    value="modal.values[field.field_id].value"
    on-value-changed="modal.setFieldValueForCustomElement($event)"
    date-picker-initializer="modal.date_picker_initializer"
    ce-one-way
></tuleap-artifact-modal-date-field>

</script>

<script type="text/ng-template" id="field-tbl.tpl.html">
<tuleap-artifact-modal-static-open-list-field
    ng-if="::field.bindings.type === 'static'"
    class="field"
    disabled="modal.isDisabled(field)"
    controller="modal.getStaticOpenListFieldController(field)"
    ce-one-way
></tuleap-artifact-modal-static-open-list-field>
<tuleap-artifact-modal-user-group-open-list-field
    ng-if="::field.bindings.type === 'ugroups'"
    class="field"
    disabled="modal.isDisabled(field)"
    controller="modal.getUserGroupOpenListFieldController(field)"
    ce-one-way
></tuleap-artifact-modal-user-group-open-list-field>
<div
    ng-if="::field.bindings.type === 'users'"
    class="field"
    tuleap-artifact-modal-users-open-list-field="field"
    is-disabled="modal.isDisabled(field)"
    value-model="modal.values[field.field_id]"
></div>
</script>

<form class="tlp-modal tlp-modal-medium-sized tuleap-artifact-modal"
    ng-class="::{ 'creation-mode': modal.creation_mode, 'edition-mode': ! modal.creation_mode }"
    role="dialog"
    aria-labelledby="artifact-modal-label"
    ng-submit="modal.submit()"
    ng-on-change="modal.onFormChange()"
    data-test="artifact-modal-form"
>
    <div class="tlp-modal-header">
        <h1 class="tlp-modal-title tuleap-artifact-modal-title"
            id="artifact-modal-label"
            ng-if="modal.creation_mode"
            translate
        >Create a new {{ modal.title }}</h1>
        <h1 class="tlp-modal-title tuleap-artifact-modal-title"
            id="artifact-modal-label"
            ng-if="! modal.creation_mode"
        >
            <span class="tuleap-artifact-modal-title-badge cross-ref-badge tlp-swatch-{{ modal.color }}">{{ modal.tracker.item_name }} #{{ ::modal.current_artifact_identifier.id }}</span>
            <span class="title">{{ modal.title }}</span>
        </h1>
        <button class="tlp-modal-close" type="button" data-dismiss="modal" aria-label="{{ Close | translate }}"><i class="fas fa-times tlp-modal-close-icon" aria-hidden="true"></i></button>
    </div>

    <modal-feedback
        parent-controller="modal.parent_feedback_controller"
        fault-controller="modal.fault_feedback_controller"
        ce-one-way
    ></modal-feedback>

    <div class="tlp-modal-body tuleap-artifact-modal-body">
        <div class="tuleap-artifact-modal-artifact">
            <div class="tuleap-artifact-modal-show-hide-fieldsets" ng-if="modal.hasHiddenFieldsets()">
                <label class="tlp-label">{{ 'Hidden fieldsets:' | translate }}</label>
                <div class="tlp-button-bar">
                    <div class="tlp-button-bar-item">
                        <input type="radio" id="button-bar-left" name="button-bar-radio" class="tlp-button-bar-checkbox" ng-click="modal.showHiddenFieldsets(true)">
                        <label for="button-bar-left" class="tlp-button-secondary tlp-button-outline">
                            <i class="fa-solid fa-eye"></i>
                        </label>
                    </div>
                    <div class="tlp-button-bar-item">
                        <input type="radio" id="button-bar-center" name="button-bar-radio" class="tlp-button-bar-checkbox" ng-click="modal.showHiddenFieldsets(false)" checked>
                        <label for="button-bar-center" class="tlp-button-secondary tlp-button-outline">
                            <i class="fa-solid fa-eye-slash"></i>
                        </label>
                    </div>
                </div>
            </div>
            <div class="tlp-alert-danger" ng-if="modal.hasRestError()">
                {{ 'Error:' | translate }} {{ modal.getRestErrorMessage() }}
            </div>
            <ng-include src="field.template_url" ng-repeat="field in modal.ordered_fields"></ng-include>
        </div>

        <tuleap-artifact-modal-comments-section
            ng-if="! modal.creation_mode"
            class="tuleap-artifact-modal-followups"
            controller="modal.getCommentsController()"
            formatted-text-controller="modal.getFormattedTextController()"
            on-new-comment="modal.setFollowupComment($event)"
            ce-one-way
        ></tuleap-artifact-modal-comments-section>
    </div>

    <div class="tlp-modal-footer">
        <tuleap-artifact-modal-file-upload-quota
            class="angular-artifact-modal-disk-usage"
            controller="modal.file_upload_quota_controller"
            ce-one-way
        ></tuleap-artifact-modal-file-upload-quota>
        <button type="button"
            class="tlp-button-primary tlp-button-outline tlp-modal-action"
            data-dismiss="modal"
            data-test="artifact-modal-cancel-button"
            translate
        >
            Cancel
        </button>
        <input
            type="submit"
            data-test="artifact-modal-save-button"
            class="tlp-modal-action"
            ng-class="{'tlp-button-danger': modal.confirm_action_to_edit, 'tlp-button-primary': !modal.confirm_action_to_edit }"
            ng-value="modal.getButtonText()"
            ng-click="modal.reopenFieldsetsWithInvalidInput($event.target.form)"
            ng-disabled="modal.isSubmitDisabled()"
            title="{{ modal.submit_disabling_reason.unwrapOr('') }}"
        >
    </div>
</form>
