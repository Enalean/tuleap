<?php

/**
* Copyright (c) Xerox Corporation, CodeX Team, 2001-2005. All rights reserved
* 
* $Id$
*
* Docman_View_RawTreeView
*/

require_once('Docman_View_View.class');
require_once('Docman_View_ItemTreeUlVisitor.class');

require_once(dirname(__FILE__).'/../Docman_ItemBo.class');

class Docman_View_RawTree extends Docman_View_View {
    
    /* protected */ function _content($params) {
        
        $itemBo = new Docman_ItemBo($params['docman'], $params['group_id']);

        $itemTree =& $itemBo->getItemSubTree($params['item']->getId(), array('user' => $params['user']));

        $displayItemTreeVisitor = new Docman_View_ItemTreeUlVisitor($this, array(
            'theme_path'             => $params['theme_path'],
            'docman_icons'           => $this->_getDocmanIcons($params),
            'default_url'            => $params['default_url'],
            //'display_description'    => isset($params['display_description']) ? $params['display_description'] : true,
            'show_options'           => ($this->_controller->request->exist('show_options') ? $this->_controller->request->get('show_options') : false)
        ));
        $itemTree->accept($displayItemTreeVisitor);
        
        echo $displayItemTreeVisitor->toHtml();    
    }
    function getActionOnIconForFolder(&$folder) {
        return (user_get_preference(PLUGIN_DOCMAN_COLLAPSE_FOLDER_PREF.'_'.$folder->getGroupId().'_'.$folder->getId()) !== false) ? 'expandFolder' : 'collapseFolder';
    }
    function getClassForFolderLink() {
        return 'docman_item_type_folder';
    }
}

?>
